#!/bin/bash

# âš™ï¸ Script de configuraciÃ³n de acceso SSH sin contraseÃ±a entre nodos ALMA

# ğŸ‘‰ Ejecutar desde alma-core para conectar con alma-resist

DEST_USER="bird"
DEST_IP="192.168.1.36"

echo "ğŸ” Verificando existencia de clave SSH..."

if [ ! -f ~/.ssh/id_ed25519 ]; then
    echo "ğŸ”§ Generando nueva clave SSH..."
    ssh-keygen -t ed25519 -C "$USER@alma-core" -f ~/.ssh/id_ed25519 -N ""
else
    echo "âœ… Clave existente detectada."
fi

echo "ğŸ“¤ Copiando clave pÃºblica a $DEST_USER@$DEST_IP ..."
ssh-copy-id $DEST_USER@$DEST_IP

echo "ğŸ” Probando conexiÃ³n SSH..."
ssh $DEST_USER@$DEST_IP "echo 'âœ… Acceso SSH automÃ¡tico exitoso desde alma-core.'"

echo "âœ… Finalizado."
