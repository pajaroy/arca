# âœ… Sprint 2.6 â€“ LLM Server + Roadmap 0.0.0.2 â€“ ALMA_RESIST

ğŸ“… VersiÃ³n objetivo: v0.0.0.2  
ğŸ§  Objetivo: Implementar el servidor MVP `idea_base_llm_server_0.0.0.4.1` y finalizar todas las tareas del roadmap tÃ©cnico v0.0.0.2


## ğŸ”’ Fase 2 â€“ Logging y Seguridad

- [x] Usar `log_crypto.py` para cifrado AES-GCM
- [ ] Registrar cada respuesta cifrada en SQLite
- [ ] Validar contra JSON Schema
- [x] Integrar con `context_tracker` para logs de actividad
- [x] Registrar resultados en `memory_graph`
- [x] Conectar `memory_graph` para indexar embeddings de respuestas
- [x] Integrar `context_tracker` al registrar actividad/logs



### âœ… Tests existentes a refactorizar

| Archivo original     | Estado         | AcciÃ³n recomendada                           |
|----------------------|----------------|----------------------------------------------|
| `test_llm.py`        | Obsoleto       | Refactorizar como `test_model_wrapper.py`    |
| `test_cli.py`        | Parcial        | Migrar a `test_api_responder.py`             |
| `test_log_crypto.py` | Parcial        | Mantener y extender                          |


### ğŸ§± Requisitos tÃ©cnicos

- Usar `pytest` como motor principal
- Evitar dependencias externas (usar mocks para modelo si es necesario)
- Las rutas de escritura deben apuntar a carpetas temporales (`tmp/` o `tests/data`)
- Agregar al menos un test por caso de error (input invÃ¡lido, fallo en carga, etc.)
- Incluir fixtures o mocks si el modelo no puede ser cargado durante CI


### ğŸ§  Notas finales

Una vez finalizada esta suite, se podrÃ¡:
- Validar automÃ¡ticamente los endpoints
- Simular interacciones completas
- Auditar integridad de archivos
- Iniciar testeo CI/CD desde CLI o pre-commit

Este plan cumple los requisitos de la Fase 3 del Sprint 2.6 y establece una base sÃ³lida para testear futuras versiones del servidor.



## ğŸ—ƒï¸ Fase 5 â€“ Versionado y Cierre

- [ ] Congelar versiÃ³n `0.0.0.1` en `docs/versiones/`
- [ ] Registrar hito del Sprint en `docs/hitos/`
- [ ] Agregar lecciones aprendidas a `lecciones_aprendidas.md`
- [ ] Confirmar cumplimiento de:
  - [ ] `python core/cli.py` responde sin errores
  - [ ] Se levanta modelo `.gguf` desde CLI
  - [ ] Se guarda memoria como JSON cifrado
  - [ ] Todas las pruebas pasan


# ğŸ“ ApÃ©ndice Sprint 2.6 â€“ Feedback TÃ©cnico de DeepSeek

Este apÃ©ndice resume los ajustes recomendados por DeepSeek para mejorar el Sprint 2.6 de ALMA_RESIST, sin duplicar tareas ya definidas. Aplica como guÃ­a adicional para asegurar escalabilidad, foco y realismo.


## ğŸ“† Plan Semanal Ajustado

### Semana 1-2:
- FastAPI + `/responder`
- `ModelWrapper`
- Manejo de errores

### Semana 2-3:
- Logging cifrado
- `memory_graph`
- `context_tracker`

### Semana 3:
- Test end-to-end
- ValidaciÃ³n de logs

### Semana 4:
- README.md + requisitos
- Congelar versiÃ³n + lecciones aprendidas


## ğŸ“Œ ApÃ©ndice: Resumen de Avance TÃ©cnico â€“ Sprint 2.6 (2025-05-26)

Este resumen agrupa todos los mÃ³dulos, archivos y tareas ya completadas hasta la fecha, correspondientes a la Fase 1 y parcialmente a la Fase 2 del sprint.


### ğŸ“ DocumentaciÃ³n estructural

- `docs/contracts/schema_prompt.json`  
- `docs/contracts/schema_respuesta.json`  
- `docs/contracts/README.md`  

Todos alineados con los modelos de entrada/salida reales.


### ğŸ§© Pendientes inmediatos

- Finalizar mÃ³dulo `memory_graph.py`
- Probar respuesta desde CLI
- Integrar logging en tiempo real (`log_writer`)
- Preparar test unitarios de entrada/salida (Fase 3)
- Iniciar documentaciÃ³n final y cierre del sprint


## ğŸ”§ Refactor y ValidaciÃ³n CriptogrÃ¡fica

Durante el Sprint 2.6 se realizÃ³ una refactorizaciÃ³n completa del mÃ³dulo `log_crypto.py`, responsable del cifrado y descifrado de logs internos en ALMA_RESIST.

### âœ… Logros:

- âœ… **Todos los tests unitarios pasaron** (16/16 `pytest`)
- ğŸ” **CorrecciÃ³n de errores crÃ­ticos** en el paso de claves y derivaciÃ³n de salt
- ğŸ§ª **Cobertura completa** con `pytest` usando `parametrize` (AES-GCM y ChaCha20)
- ğŸ“„ Se redactÃ³ un **README tÃ©cnico** con descripciÃ³n de uso, funciones, algoritmos soportados y dependencias

### ğŸ› ï¸ Cambios tÃ©cnicos principales:

- `decrypt_log()` ahora recibe una `password` y se encarga internamente de derivar la clave + salt.
- Se eliminaron llamadas errÃ³neas a tuplas como claves directas.
- ModularizaciÃ³n de funciones internas: `_get_cipher`, `_read_salt`, `_derive_key`.

