# üß† Prompt Maestro ‚Äî Cargador Universal de Memorias Institucionales (ALMA_RESIST)

**Fecha:** 2025-06-06  
**Responsables:** Santi (humano), Kael (auditor CLI)  
**M√≥dulo:** /home/bird/alma_resist/control_central/memorias/  
**Estado:** Vigente


## ‚öôÔ∏è Requerimientos funcionales

1. **Entrada flexible**
   - Soporte para JSON y YAML (individual o lote/array).
   - Input por archivo (`--input`), por stdin (`--stdin`), o modo interactivo (opcional).

2. **Validaci√≥n estricta**
   - Validar cada memoria con JSON/YAML Schema oficial (adjuntar o dejar preparado para versionar).
   - Campos obligatorios: `id`, `tipo`, `fecha`, `modulo`, `tema`, `status`, `responsable`, `tags`, `resumen`, `impacto`/`recomendaciones`.
   - Rechazar si falta alg√∫n campo obligatorio o si hay claves desconocidas; mensajes de error expl√≠citos y sugerencias.

3. **Carga eficiente y robusta**
   - Evitar duplicados por campo `id`.
   - Soporte para carga en lote y reporte resumido post-carga (agregados, rechazados, duplicados).
   - Flag `--dry-run` para validar sin modificar archivos.
   - Escritura at√≥mica: escribir primero en archivo temporal y luego reemplazar.
   - Backup autom√°tico antes de cada modificaci√≥n.
   - Manejo seguro de concurrencia (file lock si es posible).
   - Log estructurado en JSON/YAML: timestamp, canal y resultado.

4. **Seguridad y trazabilidad**
   - (Opcional) Hash/checksum por registro para integridad.
   - Registrar canal/origen de carga (CLI, IA, API).
   - Registrar usuario/IA responsable.
   - Control de versiones del script y del archivo destino.

5. **CLI amigable y escalable**
   - Ayuda y flags claros (`--help`, `--input`, `--dest`, `--dry-run`, etc).
   - Opci√≥n de conversi√≥n masiva YAML‚ÜîJSON.
   - Reportes por tags, fechas, tipos desde CLI.
   - Preparado para exponer l√≥gica como API local en el futuro.
   - Mensajes y documentaci√≥n listos para multi-idioma.

6. **Documentaci√≥n y pruebas**
   - README y docstring extendido.
   - Casos de prueba: input v√°lido, campos faltantes, duplicados, tipos err√≥neos, fechas mal formateadas, edge cases.


## üìÅ Rutas relevantes

- `/home/bird/alma_resist/control_central/memorias/memorias.json`
- `/home/bird/alma_resist/control_central/memorias/bitacora_viva.json`
- `/home/bird/alma_resist/control_central/memorias/memorias.yaml`
- `/home/bird/alma_resist/control_central/memorias/bitacora_viva.yaml`

