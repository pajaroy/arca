---
module: versiones/v0_0_0_5_llm_server/idea_base_llm_server_0_0_0_4_1
type: core
status: in_progress
created: '2025-05-26'
linked_to:
- metodologia_doc_ia_v2.md

---
## ðŸ”§ Componentes del MVP

### 1. API bÃ¡sica con FastAPI

- Endpoint `/responder` que recibe un prompt y devuelve la respuesta del modelo
    
- AsÃ­ncrono, con `asyncio.to_thread()` para ejecutar LLM sin bloquear
    

### 2. `ModelWrapper`

- Clase base para instanciar cualquier modelo local (inicia con `llama.cpp`)
    
- MÃ©todos: `.load_model()`, `.generate()`
    
- CuantizaciÃ³n: Q4 (GGUF) para hardware modesto
    

### 3. `TransportLayer`

- Interfaz abstracta: `.send(data, endpoint)`, `.receive(endpoint)`
    
- ImplementaciÃ³n MVP: lectura/escritura local con JSON
    

### 4. Logging seguro

- Cifrado AES-GCM
    
- Almacenamiento en SQLite
    
- Integrado con `context_tracker` (registro de inputs/salidas)
    

### 5. `memory_graph`

- Registro semÃ¡ntico post-inferencia
    
- IndexaciÃ³n de prompt + respuesta
    

### 6. Contratos de Datos

- Esquemas JSON en `docs/contracts/`:
    
    - `schema_prompt.json`
        
    - `schema_respuesta.json`
        

---

## ðŸ”¬ Arquitectura del MVP

```
[CLI]
  â†“
FastAPI /responder
  â†“
ModelWrapper (llama.cpp)
  â†“
TransportLayer (local JSON)
  â†“
Respuesta
  â†“
Log + memory_graph
```

---

## ðŸ› Estructura Recomendada

```
llm_server/
â”œâ”€â”€ main.py                # API principal
â”œâ”€â”€ model_wrapper.py       # Clase base
â”œâ”€â”€ transport_layer.py     # AbstracciÃ³n de transporte
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ schema_prompt.json
â”‚   â””â”€â”€ schema_respuesta.json
â”œâ”€â”€ integration/
â”‚   â”œâ”€â”€ context_tracker.py
â”‚   â””â”€â”€ memory_graph.py
â””â”€â”€ utils/
    â””â”€â”€ log_crypto.py      # AES-GCM
```

---

## ðŸ”„ Fases Post-MVP

- v0.0.0.4.2 â†’ Logging paralelizado + reflexiones automÃ¡ticas
    
- v0.5.0 â†’ Docker por modelo + TransportLayer con gRPC
    
- v0.6.0 â†’ ModelRouter basado en embeddings
    

---

## ðŸ“ˆ Meta

Establecer una arquitectura sÃ³lida, Ã©tica y modular que permita a ALMA pensar crÃ­ticamente con un solo modelo, registrar sus reflexiones y preparar el camino para operar simbÃ³licamente a escala.

> "Una mente no se expande con potencia, sino con coherencia."