---
module: versiones/v0_0_0_5_llm_server/idea_base_llm_server_0_0_0_4_1
type: core
status: in_progress
created: '2025-05-26'
linked_to:
- metodologia_doc_ia_v2.md

---
## 🔧 Componentes del MVP

### 1. API básica con FastAPI

- Endpoint `/responder` que recibe un prompt y devuelve la respuesta del modelo
    
- Asíncrono, con `asyncio.to_thread()` para ejecutar LLM sin bloquear
    

### 2. `ModelWrapper`

- Clase base para instanciar cualquier modelo local (inicia con `llama.cpp`)
    
- Métodos: `.load_model()`, `.generate()`
    
- Cuantización: Q4 (GGUF) para hardware modesto
    

### 3. `TransportLayer`

- Interfaz abstracta: `.send(data, endpoint)`, `.receive(endpoint)`
    
- Implementación MVP: lectura/escritura local con JSON
    

### 4. Logging seguro

- Cifrado AES-GCM
    
- Almacenamiento en SQLite
    
- Integrado con `context_tracker` (registro de inputs/salidas)
    

### 5. `memory_graph`

- Registro semántico post-inferencia
    
- Indexación de prompt + respuesta
    

### 6. Contratos de Datos

- Esquemas JSON en `docs/contracts/`:
    
    - `schema_prompt.json`
        
    - `schema_respuesta.json`
        

---

## 🔬 Arquitectura del MVP

```
[CLI]
  ↓
FastAPI /responder
  ↓
ModelWrapper (llama.cpp)
  ↓
TransportLayer (local JSON)
  ↓
Respuesta
  ↓
Log + memory_graph
```

---

## 🏛 Estructura Recomendada

```
llm_server/
├── main.py                # API principal
├── model_wrapper.py       # Clase base
├── transport_layer.py     # Abstracción de transporte
├── contracts/
│   ├── schema_prompt.json
│   └── schema_respuesta.json
├── integration/
│   ├── context_tracker.py
│   └── memory_graph.py
└── utils/
    └── log_crypto.py      # AES-GCM
```

---

## 🔄 Fases Post-MVP

- v0.0.0.4.2 → Logging paralelizado + reflexiones automáticas
    
- v0.5.0 → Docker por modelo + TransportLayer con gRPC
    
- v0.6.0 → ModelRouter basado en embeddings
    

---

## 📈 Meta

Establecer una arquitectura sólida, ética y modular que permita a ALMA pensar críticamente con un solo modelo, registrar sus reflexiones y preparar el camino para operar simbólicamente a escala.

> "Una mente no se expande con potencia, sino con coherencia."