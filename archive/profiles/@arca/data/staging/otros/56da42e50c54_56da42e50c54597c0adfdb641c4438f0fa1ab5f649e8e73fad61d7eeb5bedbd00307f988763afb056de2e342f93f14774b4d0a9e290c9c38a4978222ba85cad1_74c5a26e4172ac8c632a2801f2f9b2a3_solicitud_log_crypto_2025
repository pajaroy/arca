---
module: prompts/solicitud_log_crypto
type: core
status: in_progress
created: '2025-05-17'
linked_to:
- metodologia_doc_ia_v2.md

---
# ğŸ§  Solicitud de MÃ³dulo: `log_crypto.py` â€“ ALMA_RESIST

## ğŸ¯ Objetivo
Implementar un mÃ³dulo Python llamado `log_crypto.py` dentro del sistema ALMA_RESIST. Este mÃ³dulo debe poder:

1. Cifrar archivos `.log` con AES-256 si la CPU es x86 y soporta AES-NI.
2. Usar ChaCha20 como alternativa en ARM o CPUs sin AES-NI.
3. Validar automÃ¡ticamente quÃ© algoritmo usar en funciÃ³n del entorno.
4. Aceptar claves personalizadas o generarlas de forma segura si no se proveen.
5. Guardar archivo cifrado como `.enc` y poder descifrarlo de forma segura.
6. Operar 100% offline y desde terminal.

---

## ğŸ“¦ Requerimientos tÃ©cnicos

- Sin conexiÃ³n a internet
- Sin librerÃ­as pesadas (no usar `cryptography` si requiere wheels externos)
- Preferencia: `pycryptodome` o `cryptography` instalable vÃ­a pip offline
- Compatible con Python 3.10+
- Docstrings estilo Google para todas las funciones
- Compatible con sistemas de archivos seguros
- ValidaciÃ³n de errores y fallback automÃ¡tico

---

## ğŸ§ª Entradas esperadas

```python
encrypt_log(input_path="logs/alma_2025-05-17.log", output_path="logs/alma_2025-05-17.enc", key=b"clave_segura")
decrypt_log(input_path="logs/alma_2025-05-17.enc", output_path="logs/alma_2025-05-17.log", key=b"clave_segura")
```

---

## âš™ï¸ Consideraciones

- El archivo `.log` puede tener 1000+ lÃ­neas en formato JSONL.
- Se debe mantener la estructura del archivo intacta al descifrar.
- AES debe usar modo CBC o GCM.
- ChaCha20 puede ser de `pycryptodome` o `cryptography`.
- Si no se detecta AES-NI, usar fallback automÃ¡ticamente.

---

## ğŸ“˜ Archivos relacionados

- `core/log_writer.py` â€“ Genera los logs
- `tests/test_log_writer.py` â€“ Verifica escritura funcional
- `docs/changelog.md`, `docs/lecciones_aprendidas.md`

---

## ğŸ“„ Salida esperada

- CÃ³digo completo de `log_crypto.py`
- Ejemplo de uso
- Manejo de errores y excepciones
- DetecciÃ³n de arquitectura con fallback automÃ¡tico

---

ğŸ“¦ Este mÃ³dulo es crÃ­tico para garantizar privacidad radical en ALMA_RESIST.
