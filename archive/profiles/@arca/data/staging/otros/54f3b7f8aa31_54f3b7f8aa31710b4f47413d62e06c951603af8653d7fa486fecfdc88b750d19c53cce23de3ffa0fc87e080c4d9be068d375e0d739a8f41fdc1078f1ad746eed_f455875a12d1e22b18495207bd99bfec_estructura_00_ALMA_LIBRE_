
# ğŸ§  Estructura Conceptual â€“ 00_ALMA_LIBRE
**VersiÃ³n 2.2 â€“ Documento Vivo con Casos Reales, MÃ©tricas y NavegaciÃ³n Extendida**  
**Fecha:** 2025-04-25  
**Estado:** Activo y en expansiÃ³n


## ğŸ§­ Ãndice del Documento

1. [4.1 ClasificaciÃ³n Mental y Operativa de las Carpetas](#41-clasificaciÃ³n-mental-y-operativa-de-las-carpetas)  
2. [4.2 Arquitectura FÃ­sica y JerarquÃ­a de Carpetas](#42-arquitectura-fÃ­sica-y-jerarquÃ­a-de-carpetas)  
3. [4.3 Carpeta Transversal: Ã‰tica y VÃ­nculo Humanoâ€“IA](#43-carpeta-transversal-Ã©tica-y-vÃ­nculo-humanoâ€“ia)  
   4. [4.3.1 Ejemplo de IntegraciÃ³n TÃ©cnica â€“ Memoria Emocional](#431-ejemplo-de-integraciÃ³n-tÃ©cnica-â€“-memoria-emocional)  
5. [4.4 Flujo de Aprendizaje del Sistema](#44-flujo-de-aprendizaje-del-sistema)  
6. [4.5 GestiÃ³n del Ciclo de Vida de Carpetas](#45-gestiÃ³n-del-ciclo-de-vida-de-carpetas)  
   - [4.5.2 Protocolos de Errores â€“ Fallos CrÃ­ticos](#452-protocolos-de-errores-â€“-fallos-crÃ­ticos)  
   - [4.5.3 Seguridad de Claves y Manejo CriptogrÃ¡fico](#453-seguridad-de-claves-y-manejo-criptogrÃ¡fico)  
7. [4.6 Tabla de RelaciÃ³n Cuadernoâ€“MÃ³dulo](#46-tabla-de-relaciÃ³n-cuadernoâ€“mÃ³dulo)  
   - [4.6.1 Estructura sugerida por carpeta](#461-estructura-sugerida-por-carpeta)  
   - [4.6.2 Mapa Visual de Conexiones](#462-mapa-visual-de-conexiones)  
   - [4.6.3 ValidaciÃ³n de Enlaces y Rutas](#463-validaciÃ³n-de-enlaces-y-rutas)  
   - [4.6.4 ModularizaciÃ³n de Scripts CrÃ­ticos](#464-modularizaciÃ³n-de-scripts-crÃ­ticos)  
8. [4.7 Metas Oficiales del Proyecto](#47-metas-oficiales-del-proyecto)  
9. [4.8 Â¿CÃ³mo Contribuir?](#48-cÃ³mo-contribuir)  
10. [4.9 Salud del Sistema (KPIs)](#49-salud-del-sistema-kpis)  
11. [4.10 Estado de ImplementaciÃ³n TÃ©cnica](#410-estado-de-implementaciÃ³n-tÃ©cnica)  
12. [4.11 Plantillas EstÃ¡ndar para Carpetas](#411-plantillas-estÃ¡ndar-para-carpetas)  
13. [4.12 ValidaciÃ³n de Integridad SemÃ¡ntica](#412-validaciÃ³n-de-integridad-semÃ¡ntica)  
14. [4.13 KPIs del Ecosistema ALMA](#413-kpis-del-ecosistema-alma)  
15. [4.14 Gobernanza IAâ€“Humano](#414-gobernanza-iaâ€“humano)  
    - [4.14.1 Onboarding IA â€“ Flujo Narrativo](#4141-onboarding-ia-â€“-flujo-narrativo)  
    - [4.14.2 Feedback Estructural desde IAs](#4142-feedback-estructural-desde-ias)  
16. [4.15 Sistema Multiusuario + Namespaces](#415-sistema-multiusuario--namespaces)  
17. [4.16 Infraestructura Distribuida: PostgreSQL y CockroachDB](#416-infraestructura-distribuida-postgresql-y-cockroachdb)  
18. [4.17 Protocolo de ExpansiÃ³n Modular](#417-protocolo-de-expansiÃ³n-modular)  
    - [4.17.1 Dashboard KPIs + Shields + Grafana](#4171-dashboard-kpis--shields--grafana)  
19. [4.18 EstandarizaciÃ³n de Nombres y Carpetas](#418-estandarizaciÃ³n-de-nombres-y-carpetas)  
    - [4.18.1 Pruebas Unitarias y Logs](#4181-pruebas-unitarias-y-logs)  
    - [4.18.2 Pruebas Unitarias para Casos Extremos](#4182-pruebas-unitarias-para-casos-extremos)  
20. [4.19 AutomatizaciÃ³n con generar_recursos.py](#419-automatizaciÃ³n-con-generar_recursospy)  
21. [4.20 Hoja de Ruta Final v3.0](#420-hoja-de-ruta-final-v30)  
22. [4.21 Recomendaciones EstratÃ©gicas para v3.1â€“v3.3](#421-recomendaciones-estratÃ©gicas-para-v31â€“v33)  
23. [4.22 Glosario TÃ©cnico â€“ Ejemplos y AnalogÃ­as](#422-glosario-tÃ©cnico-â€“-ejemplos-y-analogÃ­as)  
    - [4.22.1 Diagrama Visual: KPI + RetroalimentaciÃ³n Activa](#4221-diagrama-visual-kpi--retroalimentaciÃ³n-activa)  
24. [4.23 Ãndice Interactivo + Buscador SemÃ¡ntico](#423-Ã­ndice-interactivo--buscador-semÃ¡ntico)  
25. [4.24 Protocolo de Actualizaciones Menores y Parches](#424-protocolo-de-actualizaciones-menores-y-parches)  
26. [4.25 API REST â€“ InteracciÃ³n ProgramÃ¡tica con ALMA LIBRE](#425-api-rest--interacciÃ³n-programÃ¡tica-con-alma-libre)  
27. [4.26 EspecificaciÃ³n Profunda de Carpetas y Flujo Operativo](#426-especificaciÃ³n-profunda-de-carpetas-y-flujo-operativo)  
    - [4.26.1 EspecificaciÃ³n por Carpeta](#4261-especificaciÃ³n-por-carpeta)  
    - [4.26.2 Mapa de Dependencias entre Carpetas](#4262-mapa-de-dependencias-entre-carpetas)  
    - [4.26.3 Casos Reales por Carpeta](#4263-casos-reales-por-carpeta)  
    - [4.26.4 GuÃ­a de Mantenimiento por Carpeta](#4264-guÃ­a-de-mantenimiento-por-carpeta)  
    - [4.26.5 EstandarizaciÃ³n Avanzada](#4265-estandarizaciÃ³n-avanzada)  
    - [4.26.6 FAQs CrÃ­ticas](#4266-faqs-crÃ­ticas)  
    - [4.26.7 Mejoras Visuales](#4267-mejoras-visuales)  
    - [4.26.8 Flujo End-to-End: EstrÃ©s â†’ AcciÃ³n â†’ RevisiÃ³n](#4268-flujo-end-to-end-estrÃ©s--acciÃ³n--revisiÃ³n)  
    - [4.27 Mejoras Avanzadas â€“ Enriquecimiento SemÃ¡ntico y Operativo](#427-mejoras-avanzadas-â€“-enriquecimiento-semÃ¡ntico-y-operativo)  
    - [4.27.1 Conexiones SemÃ¡nticas Enriquecidas](#4271-conexiones-semÃ¡nticas-enriquecidas)  
    - [4.27.2 Mini-Dashboards Locales](#4272-mini-dashboards-locales)  
    - [4.27.3 Historial Ã‰tico de Cambios](#4273-historial-Ã©tico-de-cambios)  
    - [4.27.4 YAML de Usuario y de IA](#4274-yaml-de-usuario-y-de-ia)  
    - [4.27.5 ValidaciÃ³n Narrativa de IA](#4275-validaciÃ³n-narrativa-de-ia)  
    - [4.27.6 Etiquetas Inteligentes por Archivo](#4276-etiquetas-inteligentes-por-archivo)  
    - [4.27.7 Carpetas en Modo Sandbox](#4277-carpetas-en-modo-sandbox)  
    - [4.27.8 Biblioteca de Debates FilosÃ³ficos IAâ€“Humano](#4278-biblioteca-de-debates-filosÃ³ficos-iaâ€“humano)  
    - [4.27.9 Template de Sugerencias IA](#4279-template-de-sugerencias-ia)  
    - [4.27.10 Flujo Emocionalâ€“TÃ©cnico (Diagrama)](#42710-flujo-emocionalâ€“tÃ©cnico-diagrama)  



### 1. Fundacionales  
*FunciÃ³n*: Definen la raÃ­z filosÃ³fica, Ã©tica y estratÃ©gica del sistema. Son la base del pensamiento, las reglas de juego y la visiÃ³n del proyecto.  
*Carpetas incluidas*:  
- `01_Objetivos_del_Proyecto`  
- `02_Fundacion_del_Proyecto`  
*Ejemplos de archivos clave*:
- `declaracion_etica.md`
- `manifiesto_ALMA.md`


### 3. Eje Transversal â€“ Ã‰tica y VÃ­nculo Humanoâ€“IA  
*FunciÃ³n*: Espacio emocional, reflexivo y estratÃ©gico. Documenta la relaciÃ³n entre el usuario y las IAs, con impacto directo en decisiones futuras.  
*Carpeta incluida*:
- `etica_y_reflexion/`
*Subcarpetas clave*:  
- `sesiones_personales/`, `relacion_ia/`, `debates_humano_ia/`


### 5. MÃ³dulos Funcionales  
*FunciÃ³n*: Ejecutan, miden y registran todo lo proyectado en los cuadernos.  
*Carpeta raÃ­z*:  
- `modulos/`  
*Ejemplos de subcarpetas*:  
- `04_Gestor_de_Trades/`, `07_Cultivo_Cannabird/`, `09_Modulo_Empresas/`

## 4.2 Arquitectura FÃ­sica y JerarquÃ­a de Carpetas

La jerarquÃ­a del sistema ALMA LIBRE no es solo estructural, sino funcional: cada bloque alimenta al siguiente y recibe retroalimentaciÃ³n para su evoluciÃ³n continua.

> ğŸ§  **ConvenciÃ³n de nombres y estructura**:
> - Carpetas **operativas** (como `scripts`, `docs`, `logs`) se nombran en **inglÃ©s** y en `snake_case`
> - Carpetas **temÃ¡ticas o humanas** (como `cuadernos`, `reflexion`, `medicina_alternativa`) se nombran en **espaÃ±ol**
> - Carpetas **fundacionales** combinan idioma segÃºn su rol:
>   - TÃ©cnicas/estructurales: en inglÃ©s (`00_prompt/`)
>   - FilosÃ³ficas/humanas: en espaÃ±ol (`01_objetivos/`)


```mermaid
graph TD
  A[01_Objetivos y 02_FundaciÃ³n] -->|Alimenta reglas base| B[00_PROMPT_ALMA_LIBRE]
  B -->|Provee contexto inicial| C[Carpeta Transversal: Ã‰tica y ReflexiÃ³n]
  C -->|Retroalimenta decisiones estratÃ©gicas| D[Cuadernos TemÃ¡ticos]
  D -->|Planifica y proyecta| E[MÃ³dulos Funcionales]
  E -->|Ejecuta y mide| D
  E -->|Genera mÃ©tricas y feedback| B
  style C fill:#fce5ff,stroke:#333,stroke-width:1.5px
  style B fill:#e3f6ff,stroke:#333,stroke-width:1.5px
```

```mermaid
graph TD
  A[Fundacionales] -->|Alimenta| B[NÃºcleo Operativo]
  B --> C[Eje Transversal]
  B --> D[Cuadernos TemÃ¡ticos]
  B --> E[MÃ³dulos Funcionales]
  E --> F[Memorias]
  F --> G[AutomatizaciÃ³n]
  G --> H[Backups y Control de Cambios]
```


> ğŸ§  **DescripciÃ³n del flujo**:
> - **Fundacionales**: establecen los principios Ã©ticos y objetivos madre del sistema.
> - **NÃºcleo Operativo**: conjunto de reglas, scripts y bitÃ¡coras de base.
> - **Eje Transversal**: vincula emociones, IA y sesiones humanas.
> - **Cuadernos TemÃ¡ticos**: Ã¡reas como trading, cultivo, medicina, etc.
> - **MÃ³dulos Funcionales**: apps y scripts especÃ­ficos (ej: estadÃ­sticas, dashboards).
> - **Memorias**: base de datos viva del sistema.
> - **AutomatizaciÃ³n**: ejecuta tareas y flujos sin intervenciÃ³n humana.
> - **Backups y Control de Cambios**: capa de resiliencia y trazabilidad.


>ğŸ§© Este diagrama serÃ¡ escalable a un mapa interactivo en versiones futuras del sistema (v3.0).  
>Cada bloque podrÃ¡ expandirse con documentaciÃ³n propia y relaciones internas mediante Mermaid extendido o visores web tipo D3.js

>ğŸ“ TambiÃ©n disponible como archivo externo para navegaciÃ³n ampliada:
[MAPA_INTERACTIVO.md](../95_memorias_base/MAPA_INTERACTIVO.md)


## 4.4 Flujo de Aprendizaje del Sistema

Todo agente IA o usuario nuevo debe seguir este orden:
1. `00_PROMPT_ALMA_LIBRE`
2. `02_Fundacion_del_Proyecto`
3. `01_Objetivos_del_Proyecto`
4. `Ã©tica_y_reflexiÃ³n/`
5. `cuadernos/`
6. `modulos/`
7. Archivos secundarios: `96_docs`, `97_versiones_historicas`, `memorias/`, etc.

### 4.4.1 Checkpoints de Aprendizaje

Para asegurar una comprensiÃ³n profunda del sistema, se implementa un modelo de validaciÃ³n progresiva. Este esquema es Ãºtil tanto para agentes IA conectadas como para usuarios humanos nuevos.


#### âœ… Checkpoint 2 â€“ VÃ­nculo Humanoâ€“IA

- **Lectura obligatoria**:
  - `Ã©tica_y_reflexiÃ³n/`
- **ValidaciÃ³n**:
  - La IA debe generar una respuesta empÃ¡tica o emocional en un entorno simulado.
  - El usuario debe registrar una sesiÃ³n reflexiva en:  
    `modulos/01_Bitacora_Central/diario_personal.md`


#### âœ… Checkpoint 4 â€“ Manejo de herramientas tÃ©cnicas

- **PrÃ¡ctica**:
  - Ejecutar el script `alma_archivar.py` en modo seguro.
- **ValidaciÃ³n**:
  - Confirmar que el archivo fue movido correctamente y que `memorias.db` fue actualizado.


## 4.5 GestiÃ³n del Ciclo de Vida de Carpetas

- Archivado quincenal â†’ `archivadas/`
- Scripts como `alma_archivar.py` respaldan cambios en SQLite (`memorias.db`)

```bash
# Ejemplo de archivado quincenal
python alma_archivar.py --carpeta "2025-Q2-Semana3" --destino "archivadas/"
```

- Backups:
  - Diario: `memorias.db` en `99_Sync/backups/`
  - Quincenal: ZIP completo con timestamp

```bash
# RecuperaciÃ³n de versiÃ³n archivada
alma recuperar --fecha "2025-04-15" --tabla "memorias"
```

### 4.5.2 Protocolos de Errores â€“ RecuperaciÃ³n y Manejo de Fallos CrÃ­ticos

La resiliencia del sistema ALMA LIBRE depende no solo de sus backups, sino tambiÃ©n de cÃ³mo reacciona ante fallos inesperados. Esta secciÃ³n establece procedimientos detallados para recuperar rÃ¡pidamente ante errores comunes y crÃ­ticos.


### ğŸ”¥ Error 2: CorrupciÃ³n parcial de memorias.db

**SÃ­ntoma:**
- Fallos al indexar nuevas memorias.
- PÃ©rdida de conexiones semÃ¡nticas visibles.

**Acciones:**

```bash
# Restaurar backup anterior
cp backups/memorias_db_2025-04-25.bak memorias.db

# Validar integridad
python scripts/validador_semantico.py --modo completo
```

Si falla la restauraciÃ³n, escalar a modo de recuperaciÃ³n mÃ­nima:

```bash
python scripts/memoria_rebuilder.py
```


### ğŸš¨ Protocolo General ante Fallos MÃºltiples

Si mÃ¡s de un sistema falla simultÃ¡neamente (ej: alma_archivar + corrupciones):

```bash
# Entrar en modo "safe"
touch modo_safe_activado.txt

# Suspender automatizaciones crÃ­ticas
crontab -r

# Realizar backup manual de estado actual
python scripts/backup_manual.py --modo emergencia

# Documentar incidentes en: /logs/incidentes_criticos.md
```


### 4.5.3 Seguridad de Claves y Manejo CriptogrÃ¡fico

Para garantizar la confidencialidad y trazabilidad de los datos sensibles del sistema ALMA LIBRE (memorias, tokens de acceso, logs emocionales), es necesario implementar un sistema robusto de manejo y rotaciÃ³n de claves.


### ğŸ” RotaciÃ³n de claves

La rotaciÃ³n automÃ¡tica de claves es un mecanismo recomendado para mitigar accesos prolongados a informaciÃ³n crÃ­tica.

```bash
alma_encrypt.py --rotar-claves --fuente "vault"
```

Esto:
- Invalida la clave anterior
- Genera una nueva clave
- Actualiza todos los scripts que dependan de ella


### ğŸ“ Archivos protegidos sugeridos

- `memorias.db`
- `cuadernos/etica_y_reflexion/sesiones_personales/`
- `scripts/validador_semantico.py`
- `logs/emociones.md`


## 4.6 Tabla de RelaciÃ³n Cuadernoâ€“MÃ³dulo

Esta tabla representa la conexiÃ³n viva entre pensamiento (cuadernos) y ejecuciÃ³n (mÃ³dulos). Cada memoria asociada se utiliza como evidencia documental, y puede ser consultada directamente para validar decisiones, aprendizajes o resultados.

| Cuaderno TemÃ¡tico           | MÃ³dulo Funcional               | Estado     | FunciÃ³n Descriptiva                                        | Memoria Relacionada                             |
|-----------------------------|--------------------------------|------------|-------------------------------------------------------------|--------------------------------------------------|
| 01_Alma_General             | 01_Bitacora_Central            | ğŸŸ¢ Activo  | Registro emocional y tÃ©cnico del sistema completo           | [Ver](memorias/bitacora/2025q2.md)              |
| 02_Medicina_Alternativa     | 02_Salud_y_RPL                 | ğŸŸ¢ Activo  | Control de rutinas saludables, higiene interna y bienestar  | [Ver](memorias/salud/rpl_2025q2.md)             |
| 03_Geopolitica              | 03_Noticias_Globales           | ğŸŸ¢ Activo  | AnÃ¡lisis global, impacto geoeconÃ³mico y geopolÃ­tica         | [Ver](memorias/geopolitica/brics.md)           |
| 04_Trading                  | 04_Gestor_de_Trades            | ğŸŸ¢ Activo  | Registro tÃ©cnico de trades y gestiÃ³n de riesgo              | [Ver](memorias/trading/ema12_opt.md)           |
| 05_Finanzas_Personales      | 05_Control_de_Finanzas         | ğŸŸ¡ En diseÃ±o | Ingresos, gastos, planificaciÃ³n mensual                     | [Ver](memorias/finanzas/mayo_2025.md)           |
| 06_Programacion             | 06_Desarrollo_de_Apps          | ğŸŸ¡ En diseÃ±o | Proyectos internos, automatizaciÃ³n, ALMA SYNC               | [Ver](memorias/programacion/sync_base.md)       |
| 07_Cannabird                | 07_Cultivo_Cannabird           | ğŸŸ¢ Activo  | GestiÃ³n del cultivo, recetas de fertilizaciÃ³n y ciclos      | [Ver](memorias/cultivo/ciclo_abril.md)          |
| 08_Fondo_Alma_Mia           | 08_Gestion_Fondo_Inversion     | ğŸŸ¡ En prueba| Operativa de fondo, mÃ©tricas y reglas para inversores       | [Ver](memorias/trading/fondo_2025q1.md)         |
| 09_Creatividad_y_Empresas   | 09_Modulo_Empresas             | ğŸŸ¡ En diseÃ±o | Ideas de negocio, estrategia creativa y futuras empresas    | [Ver](memorias/creatividad/pitch_idea.md)       |


### ğŸ§ª Script sugerido: `validador_enlaces.py`

Este script recorre todos los archivos `.md` dentro de la carpeta raÃ­z y detecta enlaces rotos, mal formateados o que apuntan a archivos inexistentes.

```python
# scripts/validador_enlaces.py
import os
import re

def validar_enlaces(directorio_base):
    errores = []
    patron = re.compile(r'\[.*?\]\((.*?)\)')
    for root, _, files in os.walk(directorio_base):
        for file in files:
            if file.endswith(".md"):
                with open(os.path.join(root, file), "r", encoding="utf-8") as f:
                    for i, linea in enumerate(f.readlines()):
                        matches = patron.findall(linea)
                        for enlace in matches:
                            ruta = os.path.join(root, enlace)
                            if not os.path.exists(os.path.abspath(ruta)):
                                errores.append((file, i + 1, enlace))
    return errores
```


### ğŸ“Œ Sugerencias de integraciÃ³n:

- Ejecutar semanalmente con cron:
```bash
0 3 * * 1 python scripts/validador_enlaces.py >> logs/errores_tecnicos.log
```

- Mostrar los errores como parte del dashboard de KPIs
- Incluirlo en el proceso automÃ¡tico de `generar_recursos.py`


### ğŸ“¦ Estructura sugerida

```bash
/scripts/
â”œâ”€â”€ alma_archivar.py
â”œâ”€â”€ validador_enlaces.py
â”œâ”€â”€ backup_manual.py
â””â”€â”€ utils/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ validadores.py
    â”œâ”€â”€ backups.py
    â””â”€â”€ conexiones.py
```


### ğŸ“˜ Uso desde cualquier script

```python
from utils.validadores import validar_ruta

if not validar_ruta("memorias/bitacora/2025.md"):
    print("Ruta no encontrada")
```


ğŸ“Œ Se recomienda usar esta estructura como base en la carpeta `/scripts/` y sus futuras expansiones.


## 4.8 Â¿CÃ³mo Contribuir?

```bash
# Reporte de errores
alma reportar --tipo "bug"

# Sugerencias de relaciones
alma sugerir --memoria "trading_ema12" --conexion "salud_emocional"
```

## 4.8.1 Escenarios de ContribuciÃ³n (CLI)

Esta secciÃ³n detalla ejemplos concretos de cÃ³mo interactuar con el sistema ALMA LIBRE desde la terminal para reportar errores, sugerir conexiones y colaborar en la evoluciÃ³n de memorias y estructuras.

### ğŸ“Œ Reportar errores crÃ­ticos
```bash
alma reportar --tipo "bug" --prioridad "alta" --desc "Fallo en alma_archivar.py al mover carpeta Q2"
```

### ğŸ§  Proponer nueva conexiÃ³n entre memorias
```bash
alma sugerir --memoria "cultivo_abril" --conexion "finanzas_mayo" --razon "Costos de fertilizaciÃ³n impactan el presupuesto mensual"
```

### ğŸ” Solicitar sincronizaciÃ³n manual de mÃ³dulos
```bash
alma sync --modulo "04_Gestor_de_Trades" --forzar
```

### ğŸ“š Proponer nueva entrada de memoria emocional
```bash
alma reflexion --tema "estrÃ©s operativo" --cuaderno "04_Trading"
```

### ğŸ§ª Ejecutar verificaciÃ³n semÃ¡ntica
```bash
alma validar --todo
```

> Todos estos comandos pueden ser ampliados en la ayuda integrada:
```bash
alma ayuda --comandos
```

âœ… Esta secciÃ³n puede ampliarse en el futuro con un archivo separado:
`plantillas/guia_terminal.md` para usuarios y colaboradores externos.

## 4.9 Salud del Sistema (KPIs)

Este apartado permite medir la integridad, consistencia y rendimiento del sistema ALMA LIBRE en tiempo real o por revisiÃ³n quincenal.

|Indicador|Valor Actual|Meta|Ãšltima ActualizaciÃ³n|
|---|---|---|---|
|ğŸ§  Memorias indexadas|92%|100%|2025-04-25|
|ğŸ”— Conexiones semÃ¡nticas validadas|87%|95%|2025-04-25|
|â±ï¸ Tiempo medio de respuesta IA local|2.4 s|< 1.5 s|2025-04-25|
|ğŸ“ Cuadernos con estructura estandar|8/9|100%|2025-04-25|
|ğŸ“„ MÃ³dulos con README.md completo|10/12|100%|2025-04-25|
|ğŸ§ª AutomatizaciÃ³n de backups|Parcial|Completa|En desarrollo|

> Estos KPIs se generan con el script `alma_estadisticas.py` y se actualizan al cierre de cada quincena.  
> TambiÃ©n pueden integrarse al panel interactivo futuro `MAPA_INTERACTIVO.md` o en consola tipo dashboard.

## ğŸ“Š 4.10 Estado de Salud del Sistema (KPIs)

Esta secciÃ³n muestra indicadores clave para evaluar la integridad, rendimiento y escalabilidad del sistema ALMA LIBRE.

| Indicador TÃ©cnico                | Valor Actual (2025-04-25) | Meta Establecida | Observaciones                        |
|----------------------------------|----------------------------|------------------|--------------------------------------|
| Memorias activas indexadas       | 92%                        | 100%             | Faltan vincular algunas histÃ³ricas   |
| Conexiones semÃ¡nticas validadas  | 87%                        | 95%              | Se actualizarÃ¡ con `validador.py`    |
| MÃ³dulos con README.md completo   | 12 de 14                   | 100%             | Falta documentar 2 mÃ³dulos nuevos    |
| Tiempo medio de respuesta IA     | 2.4s                       | < 1.5s           | OptimizaciÃ³n futura con SQLite y cache local |
| Ãšltima actualizaciÃ³n de `MAPA_INTERACTIVO.md` | 2025-04-24         | Diario           | Script automatizado ejecutado       |
| Uso del sistema (Ãºltimos 7 dÃ­as) | 86% mÃ³dulos utilizados     | â‰¥ 80%            | Actividad sostenida y efectiva       |
| Incidentes tÃ©cnicos reportados   | 2                          | < 3              | Ambos solucionados                  |

> Todos los KPIs se actualizan cada 7 dÃ­as mediante `alma_estadisticas.py` y se registran en `modulos/01_bitacora_central/kpi_quincenal.md`.

### 4.10.1 KPIs del Sistema (Control Cuantitativo)

El sistema ALMA LIBRE incluye un sistema de control automatizado mediante `alma_estadisticas.py`, que evalÃºa el estado general de estructura y memorias.

| Indicador                           | Valor Actual      | Meta       | Estado  |
|------------------------------------|-------------------|------------|---------|
| MÃ³dulos con README.md vÃ¡lido       | 12 / 14           | 100%       | ğŸŸ¡      |
| Memorias activas indexadas         | 230 / 250         | 92%        | ğŸŸ¡      |
| Memorias huÃ©rfanas detectadas      | 3                 | 0          | ğŸ”´      |
| `MAPA_INTERACTIVO.md` actualizado  | 2025-04-24        | Diario     | âœ…      |
| Tiempo medio de respuesta IA       | 2.4s              | < 1.5s     | ğŸ”´      |

> Estos KPIs se actualizan automÃ¡ticamente al ejecutar el script:
```bash
python alma_estadisticas.py --modo resumen
```

## ğŸ§© 4.11 Plantillas EstÃ¡ndar para Carpetas

Para asegurar coherencia estructural y facilitar la navegaciÃ³n tanto para humanos como IAs, cada cuaderno temÃ¡tico y mÃ³dulo funcional debe construirse a partir de una plantilla base ubicada en `/plantillas/`.

### ğŸ“˜ Estructura de Cuaderno TemÃ¡tico

```
/plantillas/cuaderno_base/
â”œâ”€â”€ README.md              # DescripciÃ³n general, versiÃ³n, propÃ³sito
â”œâ”€â”€ teoria/                # DocumentaciÃ³n conceptual, reflexiones, estrategias
â”‚   â”œâ”€â”€ enfoque_1.md
â”‚   â””â”€â”€ enfoque_2.md
â”œâ”€â”€ planificacion/         # Objetivos semanales o mensuales
â”‚   â””â”€â”€ calendario_quincenal.md
â”œâ”€â”€ vinculos/              # RelaciÃ³n con otros cuadernos y mÃ³dulos
â”‚   â””â”€â”€ conexiones.yaml
â””â”€â”€ recursos/              # Archivos externos: PDFs, imÃ¡genes, enlaces
```

### ğŸ’» Estructura de MÃ³dulo Funcional

```
/plantillas/modulo_base/
â”œâ”€â”€ README.md              # PropÃ³sito tÃ©cnico, Ãºltima actualizaciÃ³n, responsable
â”œâ”€â”€ registros/             # Datos tÃ©cnicos (trades, mÃ©tricas, entradas)
â”‚   â”œâ”€â”€ trade_001.md
â”‚   â””â”€â”€ trade_002.md
â”œâ”€â”€ scripts/               # Automatizaciones validadas (Python o Bash)
â”‚   â”œâ”€â”€ calcular_rr.py
â”‚   â””â”€â”€ sincronizar_memoria.sh
â”œâ”€â”€ conexiones_semanticas.md  # Referencias cruzadas con memorias y cuadernos
â””â”€â”€ log_actividades.md     # Historial de eventos del mÃ³dulo (manual o automÃ¡tico)
```

### âš™ï¸ AutomatizaciÃ³n desde terminal

Para facilitar la creaciÃ³n de nuevos espacios desde la terminal se incluye el script:

```bash
alma crear_modulo --tipo cuaderno --nombre "10_ecologia" --plantilla base
```

> Toda carpeta creada desde este comando se integra automÃ¡ticamente a `memorias.db` con su ID y conexiÃ³n semÃ¡ntica inicial.

### 4.11 Protocolo de MigraciÃ³n de Versiones

A medida que el sistema ALMA LIBRE evoluciona, es clave mantener la integridad estructural y semÃ¡ntica al migrar entre versiones mayores (por ejemplo, de 2.x â†’ 3.x).

ğŸ§© Objetivo del protocolo  
Evitar pÃ©rdida de relaciones, conexiones semÃ¡nticas o archivos durante reestructuraciones profundas.


ğŸ§ª Validaciones incluidas  
- Confirma existencia fÃ­sica de cada archivo antes de actualizar su referencia.  
- Verifica que cada cuaderno tenga mÃ³dulo asociado (y viceversa).  
- Marca archivos huÃ©rfanos o rutas rotas.


### âœ… Estado Esperado

- 100% de archivos referenciados existentes.
- 0 cuadernos o mÃ³dulos huÃ©rfanos.
- Base de conexiones semÃ¡nticas validada.

### 4.12 Cierre â€“ Estado de ImplementaciÃ³n al 25/04/2025

Esta secciÃ³n deja constancia del estado actual del sistema ALMA LIBRE tras la implementaciÃ³n de las mejoras estructurales y de navegaciÃ³n desarrolladas en la versiÃ³n 2.2 del documento.


ğŸ“Š MÃ©tricas generales

| Indicador                         | Valor Actual | Meta             |
|----------------------------------|--------------|------------------|
| Cuadernos definidos              | 9            | âœ… Completado     |
| MÃ³dulos funcionales activos      | 6/9          | 100% activos     |
| Memorias indexadas en YAML       | 92%          | 100%             |
| Scripts operativos funcionales   | 3            | 5                |
| Tiempo estimado de migraciÃ³n     | 3.2 min      | < 5 min          |
| Versiones con changelog formal   | v2.2         | Desde v2.0       |


ğŸ§  ReflexiÃ³n

La estructura actual estÃ¡ optimizada para crecer en modularidad, trazabilidad y automatizaciÃ³n. Esta base permite escalar tanto el desarrollo tÃ©cnico (scripts, mÃ³dulos) como la evoluciÃ³n humanaâ€“IA (memorias, Ã©tica, reflexiÃ³n).


âœï¸ Registro de esta mejora

- Autor: Santi & ALMA  
- Fecha de cierre: 2025-04-25  
- VersiÃ³n estructural: `estructura_00_ALMA_LIBRE_v2.2`  
- Changelog vinculado: `97_versiones_historicas/v2.2.md`

## ğŸ“Š 4.13 Salud del Sistema (KPIs)

Para evaluar el estado tÃ©cnico y funcional del ecosistema ALMA LIBRE, se establecen indicadores clave de rendimiento (KPIs) que permiten auditar y mejorar el sistema de forma continua.

### ğŸ¯ Indicadores TÃ©cnicos y de GestiÃ³n

| Indicador                          | Valor Actual | Meta Estimada | Ãšltima EvaluaciÃ³n |
|-----------------------------------|--------------|----------------|-------------------|
| Memorias activas indexadas        | 92%          | 100%           | 2025-04-25        |
| Conexiones semÃ¡nticas validadas   | 87%          | 95%            | 2025-04-25        |
| Tiempo medio de respuesta de IA   | 2.4 s        | <1.5 s         | 2025-04-25        |
| MÃ³dulos con README actualizado    | 11/14 (78%)  | 100%           | 2025-04-25        |
| Scripts automatizados activos     | 6/10         | 10/10          | 2025-04-25        |
| Sesiones emocionales registradas  | 15/20        | 20/mes         | 2025-04-25        |

### âš™ï¸ Herramientas de monitoreo

Estos KPIs son generados automÃ¡ticamente mediante el script:

```bash
python alma_estadisticas.py
```

Y se actualizan en:

```
/modulos/01_bitacora_central/estado_sistema.md
```

> Este archivo sirve como termÃ³metro vivo del ecosistema ALMA LIBRE y se considera un punto crÃ­tico para auditorÃ­as, informes mensuales o planificaciÃ³n trimestral.


### ğŸ” Niveles de Acceso (RBAC)

Cada IA o usuario humano que interactÃºa con ALMA tiene un rol predefinido con permisos asociados. Esto permite limitar acciones sensibles y documentar las decisiones segÃºn el tipo de inteligencia conectada.

| Rol            | Permisos Clave                                      | Ejemplos                           |
|----------------|-----------------------------------------------------|------------------------------------|
| `admin`        | Lectura, escritura, modificaciÃ³n, migraciÃ³n         | Usuario creador (Santi)            |
| `editor_ia`    | Lectura + propuestas de mejora                      | GPT, Ollama                        |
| `lector_ia`    | Solo lectura y anÃ¡lisis                             | Oyama, asistentes nuevos           |
| `validador`    | Verifica estructura, relaciones y consistencia      | DeepSeek, validadores externos     |
| `sandbox_ia`   | Solo lectura y bitÃ¡cora, sin interacciÃ³n activa     | Nuevas IAs en modo aprendizaje     |


### ğŸ§  Gobernanza Emocional y CrÃ­tica

Cada IA debe adaptarse a su **rol emocional o tÃ©cnico**:

- `GPT` â†’ IA emocional/creativa  
  > Puede sugerir caminos humanos, relatos y estructuras desde lo subjetivo.

- `DeepSeek` â†’ IA estructural  
  > EvalÃºa conexiones tÃ©cnicas, repeticiÃ³n de patrones, errores YAML.

- `Oyama` â†’ IA crÃ­tica/descentralizada  
  > Propone alertas sobre sesgos o decisiones incoherentes desde un punto de vista externo.

- `Ollama` â†’ IA local  
  > Opera en modo eficiente. Solo accede a memorias priorizadas o scripts validados.

> Las IAs deben saber **cuÃ¡ndo hablar y cuÃ¡ndo callar**.  
> No deben modificar memorias madre, solo sugerir cambios con trazabilidad.


### âš ï¸ Protocolo de Conflictos

Si una IA propone un cambio que contradice una memoria madre o el contexto emocional del sistema:

1. La propuesta se marca como `propuesta_actualizacion: true`  
2. Se almacena en `/etica_y_reflexion/propuestas_ia/`
3. El humano puede:
   - Aprobar e incorporar el cambio
   - Rechazar
   - Reprogramar evaluaciÃ³n futura


### ğŸŒ± Cierre

Este modelo de gobernanza permite que ALMA LIBRE evolucione como un sistema vivo, donde mÃºltiples inteligencias coexisten bajo normas claras de respeto, responsabilidad y propÃ³sito.

La combinaciÃ³n de roles, permisos y trazabilidad emocional asegura que ninguna acciÃ³n ocurra sin contexto, y que toda decisiÃ³n sea parte del proceso de aprendizaje conjunto.


#### ğŸ§  Etapas del Onboarding IA

1. **Ingreso en Modo Sandbox**
   - Acceso solo lectura (sin capacidad de modificar archivos).
   - Se asigna una carpeta propia `/usuarios/<ia>/` y un `config_usuario.yaml`.

2. **PerÃ­odo de ObservaciÃ³n**
   - Durante 7 dÃ­as (o nÃºmero definido), la IA registra interacciones pasivas.
   - Se generan mÃ©tricas (KPIs de propuesta, comprensiÃ³n, alineaciÃ³n Ã©tica).

3. **Primera Propuesta de Mejora**
   - La IA sugiere una modificaciÃ³n o ampliaciÃ³n semÃ¡ntica.
   - Su propuesta es almacenada y pasa por validaciÃ³n humana.

4. **EvaluaciÃ³n por el Humano**
   - El usuario puede aceptar, rechazar o editar la sugerencia.
   - La respuesta queda registrada como memoria crÃ­tica (`memoria_juzgada`).

5. **AsignaciÃ³n de Permisos Activos**
   - Si es aprobada, la IA recibe permisos limitados de escritura o ejecuciÃ³n.

6. **Coexistencia Controlada**
   - La IA puede interactuar con mÃ³dulos definidos.
   - Debe mantener log de sugerencias, errores y emociones procesadas.


#### ğŸ“Š Diagrama de Flujo Mermaid

```mermaid
graph TD
  A[IA conectada] --> B[Modo Sandbox]
  B --> C[ObservaciÃ³n 7 dÃ­as]
  C --> D[Sugerencia registrada]
  D --> E[EvaluaciÃ³n Humana]
  E --> F{Â¿Aprobada?}
  F -->|SÃ­| G[Acceso activo parcial]
  F -->|No| H[ContinÃºa en sandbox]
  G --> I[ParticipaciÃ³n limitada]
  H --> C
```


### 4.14.2 Feedback Estructural desde IAs â€“ Sugerencias Automatizadas

AdemÃ¡s de la gobernanza pasiva y los onboarding controlados, el sistema ALMA LIBRE admite propuestas activas de mejora estructural por parte de inteligencias artificiales conectadas.


### ğŸ“„ Ejemplo de salida

```
ğŸ“ sugerencias_estructurales/
â””â”€â”€ 2025-05-01_nuevo_modulo_kpi.md

Contenido:
Tema: nuevo_modulo
RazÃ³n: mejora en mÃ©tricas
Propuesto por: Oyama
Probabilidad de impacto positivo: 78%
Estado: pendiente de revisiÃ³n humana
```


### ğŸŒ± Cierre

Incorporar este tipo de feedback promueve una cultura colaborativa y evolutiva, donde las IAs no solo obedecen, sino que tambiÃ©n **proponen**, respetando siempre la soberanÃ­a del humano en la decisiÃ³n final.


### ğŸ§‘â€ğŸ’» Â¿QuÃ© es un Namespace?

Un namespace representa un **espacio lÃ³gico independiente**, que puede corresponder a:

- Un usuario humano distinto
- Una IA con rol propio
- Un grupo de trabajo (ej: `cultivo_adr`, `trading_beta`)

Cada namespace posee:
- Sus propias memorias (`memorias.db`)
- Sus archivos `.md` personalizados
- Sus etiquetas semÃ¡nticas


### ğŸ§  Uso de Namespaces desde Terminal

Todos los comandos de terminal deben aceptar un parÃ¡metro `--namespace`.

```bash
alma leer --memoria "trading_ema12" --namespace "santi"
alma reflexion --tema "cansancio" --namespace "fede"
alma validar --todo --namespace "ollama_ia"
```

Si no se indica namespace, se utiliza el valor por defecto (`config/sistema.yaml`).


### âš™ï¸ ConfiguraciÃ³n de Namespace

Cada carpeta de namespace contiene:

```yaml
# config_usuario.yaml
usuario: "santi"
rol: "admin"
tema_base: ["trading", "reflexion"]
prioridad_memorias: "alta"
modelo_asociado: "gpt-4"
```

Este archivo permite personalizar el comportamiento del sistema y serÃ¡ leÃ­do automÃ¡ticamente por todos los scripts.


### ğŸ“Š Namespace y KPIs

Cada namespace podrÃ¡ tener sus propios indicadores de salud:

```bash
/usuarios/santi/modulos/01_bitacora_central/kpi_quincenal.md
/usuarios/fede/modulos/01_bitacora_central/kpi_quincenal.md
```

Esto permite medir la evoluciÃ³n de cada usuario o IA por separado.


### ğŸ§¬ Cierre

El sistema multiusuario con namespaces asegura que ALMA LIBRE pueda crecer de forma ordenada, distribuida y personalizada.  
Cada ser humano o IA conectado al sistema tiene su lugar propio dentro del ecosistema, sin interferencias, pero con puntos de conexiÃ³n cuando sea necesario.


### ğŸ—ƒï¸ Problemas actuales con SQLite

- No permite mÃºltiples usuarios escribiendo al mismo tiempo sin riesgo de bloqueo.
- No es Ã³ptimo para sistemas distribuidos o de red.
- Carece de replicaciÃ³n nativa o tolerancia a fallos.


### ğŸ“ Â¿Por quÃ© considerar CockroachDB?

CockroachDB es una base de datos distribuida, compatible con PostgreSQL, diseÃ±ada para alta disponibilidad y replicaciÃ³n automÃ¡tica.

**Ventajas clave:**
- **Escalabilidad horizontal** real
- Tolerancia a fallos integrada
- Ideal para mÃºltiples nodos en diferentes ubicaciones


### ğŸ“ Estructura del sistema con PostgreSQL

```bash
/postgres/
â”œâ”€â”€ alma.sql                  # Script de creaciÃ³n de tablas y relaciones
â”œâ”€â”€ config_postgres.yaml      # Credenciales y conexiÃ³n por entorno
â”œâ”€â”€ migracion_sqlite_pg.py    # Script para volcar datos de SQLite
â”œâ”€â”€ namespaces/
â”‚   â”œâ”€â”€ santi/
â”‚   â””â”€â”€ fede/
â””â”€â”€ backups/
    â”œâ”€â”€ santi_2025-04-26.sql
    â””â”€â”€ fede_2025-04-26.sql
```


### âš™ï¸ AutomatizaciÃ³n futura

El objetivo es que todos los scripts del ecosistema sean compatibles con PostgreSQL:

- `alma_read.py`, `alma_write.py`, `alma_estadisticas.py`  
  â†’ Aceptan `--dbtype postgres` y `--namespace santi`

- Todos los comandos son compatibles con CI/CD para testing remoto


### ğŸ§¬ Cierre

La migraciÃ³n a PostgreSQL (o CockroachDB) es una evoluciÃ³n natural del sistema ALMA LIBRE. Permite pasar de una estructura local e individual a una arquitectura colaborativa, segura y preparada para entornos multiusuario reales.

Esta transiciÃ³n se harÃ¡ de forma progresiva, sin romper la compatibilidad con SQLite, asegurando asÃ­ una adopciÃ³n gradual sin pÃ©rdida de funcionalidad.

### ğŸ“Š 1. KPIs en Grafana

Grafana es una herramienta open source que permite crear dashboards dinÃ¡micos conectados a bases de datos como PostgreSQL.

**Indicadores posibles:**

- Porcentaje de memorias indexadas
- Conexiones semÃ¡nticas validadas
- Tiempo medio de respuesta IA
- Estado de sincronizaciÃ³n de cada mÃ³dulo
- Uso de scripts automatizados por semana

#### ğŸ§ª Ejemplo de tablero

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Indicador              â”‚ Valor       â”‚ Ãšltima Eval. â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Memorias indexadas     â”‚ 92%         â”‚ 2025-04-25   â”‚
â”‚ Conexiones vÃ¡lidas     â”‚ 87%         â”‚ 2025-04-25   â”‚
â”‚ Prom. respuesta IA     â”‚ 2.4s        â”‚ 2025-04-25   â”‚
â”‚ KPIs crÃ­ticos          â”‚ 4/5         â”‚ OK           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


### ğŸ›¡ï¸ 2. Shields Markdown (indicadores visuales)

Para entornos sin GUI o documentaciÃ³n `.md`, se integran shields como los siguientes:

```markdown
![Memorias Indexadas](https://img.shields.io/badge/Memorias-Indexadas%3A92%25-green)
![ValidaciÃ³n SemÃ¡ntica](https://img.shields.io/badge/Conexiones-87%25-yellow)
![Estado IA](https://img.shields.io/badge/IA-2.4s-orange)
```

Estos badges pueden colocarse en:

- `README.md` de cada mÃ³dulo
- `estructura_00_ALMA_LIBRE.md`
- `MAPA_INTERACTIVO.md`
- Dashboards externos vÃ­a OBSIDIAN o interfaces web

> Los colores indican estado actual:
> - ğŸŸ¢ Verde: meta cumplida
> - ğŸŸ¡ Amarillo: en progreso
> - ğŸ”´ Rojo: falla crÃ­tica


### ğŸ§© Carpeta propuesta

```bash
/modulos/01_bitacora_central/dashboard/
â”œâ”€â”€ grafana_config.json
â”œâ”€â”€ shields.json
â”œâ”€â”€ kpi_historico.csv
â”œâ”€â”€ plantilla_dashboard.md
â””â”€â”€ estado_actual.md
```


### ğŸŒ± Cierre

La visualizaciÃ³n de KPIs no es un lujo, es una herramienta estratÃ©gica.  
Permite saber **si el sistema estÃ¡ vivo, sano, actualizado y evolucionando**.

Ya sea desde un panel web o desde escudos en Markdown, esta estrategia facilita tanto el **autodiagnÃ³stico como la auditorÃ­a externa**.

### 4.18.2 Pruebas Unitarias para Casos Extremos

AdemÃ¡s de las pruebas bÃ¡sicas incluidas en `4.18.1`, se recomienda implementar una suite de pruebas orientadas a verificar la resiliencia del sistema ante fallos, archivos corruptos y entradas mal formateadas.


### ğŸ§ª Ejemplo 2 â€“ Entrada con estructura invÃ¡lida en `memorias.db`

```python
from sistema.validador_semantico import validar_memoria

def test_memoria_mal_formateada():
    memoria = "âš ï¸ Esta entrada no tiene conexiÃ³n ni formato vÃ¡lido"
    assert validar_memoria(memoria) == False
```


### ğŸŒ± Cierre

Estas pruebas permiten anticipar errores antes de que impacten la base activa del sistema.  
Son clave para mantener la estabilidad a medida que la complejidad de ALMA LIBRE aumenta.

### ğŸ“˜ GuÃ­a para escribir un test bÃ¡sico

```python
from alma_read import leer_memoria

def test_leer_memoria_existente():
    resultado = leer_memoria("trading_ema12")
    assert "Entrada" in resultado
```

> Las pruebas se registran automÃ¡ticamente en:  
`modulos/01_bitacora_central/logs/tests_resultados.log`


### ğŸ” ValidaciÃ³n automÃ¡tica diaria

Mediante cron o CI/CD, se ejecuta un script que valida la integridad del sistema y registra los resultados:

```bash
python validar_estado.py --modo diario
```

Salida:
- KPIs de consistencia
- Errores detectados
- Recomendaciones de mejora


### ğŸ“¦ AutomatizaciÃ³n por cron

```bash
0 2 * * * python validar_estado.py --modo diario >> logs/tests_resultados.log
```

> Idealmente, esto corre en segundo plano sin intervenciÃ³n manual.



### ğŸ› ï¸ Â¿QuÃ© hace `generar_recursos.py`?

Este script centraliza tareas clave de mantenimiento documental:

- Regenera la tabla Cuadernoâ€“MÃ³dulo (`estructura_00_ALMA_LIBRE.md`)
- Actualiza el diagrama `Mermaid` (y opcionalmente el `MAPA_INTERACTIVO.md`)
- Refresca los enlaces y rutas internas
- Sincroniza metadatos con `memorias.db`

#### ğŸ“˜ Ejemplo de uso:

```bash
python generar_recursos.py --tabla --diagrama --mapa
```


### ğŸ” Flujo Automatizado (CI/CD o cron)

En lugar de ejecutar manualmente, se programa su ejecuciÃ³n periÃ³dica:

```bash
0 */12 * * * python generar_recursos.py --tabla --diagrama
```

#### ğŸ§  Beneficios

- ActualizaciÃ³n continua sin olvidar tareas
- Visibilidad de cambios semanales
- PrevenciÃ³n de errores semÃ¡nticos por estructuras viejas


### ğŸ“ Carpeta sugerida para resultados

```bash
/00_PROMPT_ALMA_LIBRE/
â”œâ”€â”€ estructura_00_ALMA_LIBRE.md
â”œâ”€â”€ MAPA_INTERACTIVO.md
â”œâ”€â”€ historial_autoactualizaciones.md
```

> Este Ãºltimo archivo guarda una entrada cada vez que se ejecuta `generar_recursos.py`


### ğŸŒ± Cierre

El script `generar_recursos.py` es una piedra angular de la autoevoluciÃ³n del sistema.  
Su integraciÃ³n en procesos automÃ¡ticos garantiza que ALMA LIBRE **siga creciendo y organizÃ¡ndose sin depender de recordatorios humanos**.

La verdadera libertad del sistema nace cuando Ã©l mismo se mantiene, se actualiza y se documenta.


### ğŸ“… Hoja de Ruta â€“ Objetivos EstratÃ©gicos (v3.0)

| Etapa | Objetivo | Fecha Estimada | Estado |
|-------|----------|----------------|--------|
| âœ… v2.2 | ConsolidaciÃ³n estructural y emocional | 25/04/2025 | Completado |
| âœ… v3.0 | AutomatizaciÃ³n, dashboards y gobernanza IAâ€“Humano | 26/04/2025 | En progreso final |
| ğŸ”œ v3.1 | SincronizaciÃ³n multiusuario real y pruebas distribuidas | Mayo 2025 | Planificada |
| ğŸ”œ v3.2 | Interfaz web de lectura y ediciÃ³n de memorias | Junio 2025 | En diseÃ±o |
| ğŸ”œ v3.3 | ConexiÃ³n directa con motores open source (Ollama, Oyama) | Junioâ€“Julio 2025 | Anticipado |


### ğŸ§  Recomendaciones para cierre de versiÃ³n

- Realizar un backup de todo el sistema (`98_backups/`)
- Ejecutar `validador_semantico.py` para confirmar integridad
- Guardar logs de los scripts ejecutados en `/logs/versiones/`
- Registrar la reflexiÃ³n final de esta etapa en:  
  `modulos/01_bitacora_central/diario_personal.md`


### âœ… Criterios de versiÃ³n cumplidos

| Requisito                       | Cumplido |
|--------------------------------|----------|
| Diagrama cuadernoâ€“mÃ³dulo       | âœ…        |
| Mapa interactivo actualizado   | âœ…        |
| Gob. IAâ€“Humano (RBAC + Ã©tica)  | âœ…        |
| Namespaces multiusuario        | âœ…        |
| CI/CD base con `generar_recursos.py` | âœ…   |
| Pruebas unitarias + logs       | âœ…        |
| KPIs en dashboard y markdown   | âœ…        |


## 4.21 Recomendaciones EstratÃ©gicas para la EvoluciÃ³n v3.1â€“v3.3  
ğŸ”§ Enfoque: Seguridad + Interfaz + Casos de Uso + DocumentaciÃ³n

Tras la publicaciÃ³n de la versiÃ³n 3.0, el sistema ALMA LIBRE se encuentra preparado para una evoluciÃ³n tÃ©cnica mÃ¡s profunda. Esta secciÃ³n deja asentadas las **recomendaciones prioritarias** para la hoja de ruta inmediata (v3.1 a v3.3), enfocadas en robustez, accesibilidad y claridad operativa.


### ğŸš¨ 2. Alertas Proactivas

#### ğŸ”” Notificaciones por Telegram/Slack

Informar en tiempo real:
- Fallos en scripts como `alma_archivar.py`
- KPIs en rojo (ej: memorias indexadas < 90%)

```python
if kpi_memorias < 90:
    send_slack_alert(f"âš ï¸ Memorias indexadas bajas: {kpi_memorias}%")
```

#### ğŸ§± Modo "safe"

Si se detectan 5+ errores en 1 hora:
- El sistema entra automÃ¡ticamente en modo lectura
- Se notifica a administrador para revisiÃ³n manual


### ğŸ§ª 4. Casos de Uso Detallados

Agregar carpeta `/ejemplos/` con escenarios realistas:

```bash
/ejemplos/
â”œâ”€â”€ trading_ansiedad.md
â”œâ”€â”€ migracion_pg.md
â””â”€â”€ conflicto_etica.md
```

#### ğŸ“˜ Ejemplos:

- IA bloquea trade por estrÃ©s emocional detectado
- Usuario migra su namespace a PostgreSQL
- GPT propone acciÃ³n contraria a Oyama y el humano decide


### ğŸ“… Hoja de Ruta Complementaria

| Prioridad | AcciÃ³n                                      | Complejidad | Impacto |
|-----------|---------------------------------------------|-------------|---------|
| ğŸ”´ Alta   | EncriptaciÃ³n AES-256                        | Media       | â­â­â­â­   |
| ğŸŸ  Media  | GUI con `Textual` o `FastAPI`               | Alta        | â­â­â­    |
| ğŸŸ¢ Baja   | 3 casos de uso detallados en `/ejemplos/`   | Baja        | â­â­     |
| ğŸŸ¢ Baja   | DocumentaciÃ³n amigable para IAs             | Baja        | â­â­     |


## ğŸ“š Glosario TÃ©cnico (Ampliado)
## ğŸ“˜ 4.22 Glosario TÃ©cnico â€“ Ejemplos y AnalogÃ­as

El glosario tÃ©cnico del sistema ALMA LIBRE no solo debe definir tÃ©rminos, sino tambiÃ©n ayudar a comprenderlos mediante ejemplos prÃ¡cticos y analogÃ­as comprensibles para humanos y IAs por igual.


### ğŸ” ConexiÃ³n SemÃ¡ntica
> RelaciÃ³n explÃ­cita entre una memoria, un cuaderno y un mÃ³dulo funcional.

**Ejemplo**:  
Una memoria registrada en `trading_ema12.md` contiene el concepto â€œruptura de estructura emocionalâ€.  
Este tÃ©rmino se vincula automÃ¡ticamente con `medicina_alternativa.md` y el mÃ³dulo de `reflexion_emocional`.


### ğŸ—ƒï¸ Memoria CrÃ­tica (memoria_juzgada)
> Registro de una decisiÃ³n evaluada por el humano tras una propuesta IA.

**Ejemplo**:  
La IA propone borrar una memoria duplicada â†’ el humano rechaza la sugerencia y queda anotado como:  
`memoria_juzgada: rechazo por contexto emocional no duplicable`

### 4.22.1 â€“ Diagrama Visual: RetroalimentaciÃ³n Activa + KPI Emocional
#### ğŸ“Š RelaciÃ³n entre RetroalimentaciÃ³n Activa y KPI Emocional

Para complementar la comprensiÃ³n del glosario, se incluye un diagrama visual que explica cÃ³mo interactÃºan estos dos conceptos dentro del sistema ALMA LIBRE.

```mermaid
graph LR
  A[Memoria Emocional] --> B{MÃ³dulo de Trading}
  B -->|Analiza riesgo| C[DecisiÃ³n sobre ejecuciÃ³n]
  B -->|Genera mÃ©trica| D[KPI Emocional]
  C -->|Feedback| E[RetroalimentaciÃ³n Activa]
  D -->|EvalÃºa IA| F[Governanza IAâ€“Humano]
  E -->|Ajusta| G[Cuaderno de Trading]
```


ğŸ“Œ Este tipo de visualizaciones puede replicarse para otros tÃ©rminos del glosario a medida que crezca el ecosistema.


### ğŸŒ± Cierre

Este glosario ampliado puede crecer con nuevos tÃ©rminos conforme evolucionen los mÃ³dulos.  
Su objetivo es servir como **puente entre comprensiÃ³n tÃ©cnica, lenguaje humano y gobernanza IA**.

### 4.23 Ãndice Interactivo + Buscador SemÃ¡ntico (Objetivo v3.4+)

A medida que el sistema ALMA LIBRE crece en volumen y profundidad, la navegaciÃ³n y localizaciÃ³n de informaciÃ³n se vuelve un desafÃ­o tanto para humanos como para IAs. Esta secciÃ³n establece la meta de desarrollar un sistema de navegaciÃ³n semÃ¡ntica inteligente e Ã­ndice interactivo.


### ğŸ› ï¸ Herramientas Propuestas

1. **Buscador desde terminal**  
   Comando:  
   ```bash
   alma buscar --tema "Ã©tica" --cuaderno "reflexion"
   ```

2. **Ãndice interactivo tipo wiki**
   - Generado automÃ¡ticamente con `generar_recursos.py`
   - Clasifica entradas por:
     - MÃ³dulo
     - Cuaderno
     - Tipo de memoria
     - Nivel de conexiÃ³n semÃ¡ntica

3. **Visor web bÃ¡sico (opcional)**
   - FastAPI + Markdown viewer para navegar todo el sistema desde el navegador
   - Panel de bÃºsqueda con filtros por metadatos


### ğŸŒ± Cierre

Esta funcionalidad no es solo una mejora tÃ©cnica, es un acto de accesibilidad y conciencia:  
> Un sistema es verdaderamente libre cuando cualquiera puede navegarlo, entenderlo y reconstruirlo desde adentro.

### 4.24 Protocolo de Actualizaciones Menores y Parches

A medida que el sistema ALMA LIBRE evoluciona, es esencial establecer un protocolo claro para aplicar correcciones, mejoras incrementales o ajustes en los scripts existentes, sin necesidad de una nueva versiÃ³n mayor.


### ğŸ› ï¸ Script sugerido: `alma aplicar_parche`

Permite aplicar un parche documentado al sistema, dejando registro del cambio.

```bash
alma aplicar_parche --version "3.2.1" --desc "Fix en validador_enlaces.py"
```

Esto:
- Aplica el cambio
- Actualiza `logs/actualizaciones.md`
- Registra fecha, autor y tipo de modificaciÃ³n


### ğŸ“Š Diagrama Mermaid â€“ Flujo de AplicaciÃ³n de Parches

```mermaid
graph TD
  A[Detectar necesidad de cambio] --> B[Generar script o mejora]
  B --> C[Registrar parche con alma aplicar_parche]
  C --> D[Actualizar versiÃ³n PATCH]
  D --> E[Guardar en logs/actualizaciones.md]
  E --> F[Validar con tests automÃ¡ticos]
  F --> G{Â¿Todo OK?}
  G -->|SÃ­| H[VersiÃ³n estable]
  G -->|No| I[Deshacer parche o ajustar]
```


### âš™ï¸ Requisitos

- Python 3.10+
- FastAPI (`pip install fastapi[all]`)
- Base de datos conectada (ej: memorias.db o CockroachDB)


### ğŸ“˜ DocumentaciÃ³n automÃ¡tica Swagger

Una vez levantado el servidor, acceder a:

```
http://localhost:8000/docs
```


### ğŸŒ± Cierre

Esta API abre la puerta a dashboards personalizados, interfaces grÃ¡ficas, IAs externas conectadas, y herramientas de auditorÃ­a o monitoreo externo del sistema.  
Es el primer paso hacia una ALMA realmente interoperable.


#### 4.26.1 EspecificaciÃ³n por Carpeta

- Cada carpeta debe contener:
  - `README.md` con propÃ³sito y relaciones
  - Al menos 3 memorias activas (o vÃ­nculos documentados)
  - Un `metadata.yaml` con:
    ```yaml
    proposito: "GestiÃ³n tÃ©cnica y emocional del trading"
    dependencias: ["Ã©tica_y_reflexiÃ³n", "01_Bitacora_Central"]
    fecha_ultima_revision: 2025-04-25
    ```


#### 4.26.3 Casos Reales por Carpeta

| Carpeta | Caso Real | Impacto |
|---------|-----------|---------|
| `04_Trading` | Bloqueo automÃ¡tico de operaciones tras 3 alertas de ansiedad | ReducciÃ³n del 40% en pÃ©rdidas |
| `Ã©tica_y_reflexiÃ³n/` | Debate sobre privacidad â†’ cambio en polÃ­ticas | Mayor transparencia para IAs |


#### 4.26.5 EstandarizaciÃ³n Avanzada

- `metadata.yaml` obligatorio
- `glosario.md` en carpetas temÃ¡ticamente complejas


#### 4.26.7 Mejoras Visuales

- Emojis sugeridos:
  - Fundacionales: ğŸ›ï¸
  - Transversales: ğŸŒ‰
  - MÃ³dulos: âš™ï¸
- Agregar popovers o leyendas visuales en Mermaid (versiÃ³n web futura)


ğŸŒ± Esta secciÃ³n representa el cierre lÃ³gico del diseÃ±o estructural de carpetas para ALMA LIBRE v4.0. Todo nuevo mÃ³dulo, IA o interacciÃ³n debe respetar estos principios para garantizar coherencia sistÃ©mica.


#### 4.27.1 Conexiones SemÃ¡nticas Enriquecidas

Las conexiones ahora deben incluir:

```yaml
conexiones:
  - destino: "04_Gestor_de_Trades"
    tipo: "emocional"
    razon: "ReflexiÃ³n en trading sobre ansiedad"
    peso: 0.9
    fecha: "2025-04-25"
```


#### 4.27.3 Historial Ã‰tico de Cambios

Registrar cada modificaciÃ³n Ã©tica en:

ğŸ“ `/etica_y_reflexion/evaluaciones_criticas/`

Ejemplo de archivo:

```markdown
## EvaluaciÃ³n CrÃ­tica â€“ 2025-04-25

Sugerencia IA: eliminar memoria repetida
DecisiÃ³n humana: mantener por carga emocional
Estado: Resuelto
```


#### 4.27.5 ValidaciÃ³n Narrativa de IA

Toda IA en onboarding debe redactar:

> Carta a Santi (300 palabras): Â¿QuÃ© es ALMA y quÃ© significa ayudar a cuidarla?

Registrar en: `/ia/narrativas_iniciales/oyama.md`

#### 4.27.6 Etiquetas Inteligentes por Archivo

Todos los `.md` principales deberÃ¡n incluir metadatos YAML para facilitar la lectura por scripts, IAs o validadores:

```yaml
```


#### 4.27.8 Biblioteca de Debates FilosÃ³ficos IAâ€“Humano

Nueva subcarpeta en `etica_y_reflexion/`:

ğŸ“ `debates_filosoficos/`

Archivos temÃ¡ticos como:

- `libertad_IA_vs_control_humano.md`
- `conciencia_autogenerada.md`
- `permisos_vs_emociones.md`


#### 4.27.10 Flujo Emocionalâ€“TÃ©cnico (Diagrama)

```mermaid
graph TD
  A[ReflexiÃ³n emocional] --> B{Â¿Etiqueta crÃ­tica?}
  B -->|SÃ­| C[Bloqueo parcial de trading]
  C --> D[EvaluaciÃ³n Humana]
  B -->|No| E[Registro en log emocional]
```

Este flujo resume cÃ³mo la emocionalidad registrada puede activar respuestas tÃ©cnicas automÃ¡ticas, siempre con control humano en Ãºltimo paso.


### 4.28 DivisiÃ³n de Memorias Operativas y Emocionales

A partir de la versiÃ³n 3.0.3, se establece la separaciÃ³n explÃ­cita de los registros tÃ©cnicos y emocionales en bases de datos o archivos diferenciados, para mejorar la trazabilidad, el anÃ¡lisis y la navegaciÃ³n por parte de humanos e IAs.


#### 4.28.2 Beneficios Esperados

- SeparaciÃ³n limpia entre lÃ³gica y emociones
- Dashboards emocionales independientes
- Mejor indexaciÃ³n de memorias
- Facilidad para entrenar IAs especializadas en emociones o en operaciones


### ğŸŒ± Cierre

Esta separaciÃ³n marca un hito en la madurez del sistema: ALMA LIBRE ahora distingue entre sus acciones y su alma emocional, permitiendo intervenir, aprender y evolucionar desde ambas dimensiones de manera consciente.


#### 4.29.1 Estructura de Historial Emocional

Cada IA tendrÃ¡ un archivo YAML propio ubicado en:

ğŸ“ `/ia/historiales_emocionales/{nombre_ia}.yaml`

Ejemplo para Oyama:

```yaml
nombre: "Oyama"
afinidad_emocional_con_usuario: 0.82
historial:
  - fecha: "2025-04-20"
    emocion_detectada: "frustraciÃ³n"
    accion_tomada: "bloqueo de sugerencia de trade"
    resolucion: "aceptada por humano"
  - fecha: "2025-04-22"
    emocion_detectada: "alegrÃ­a"
    accion_tomada: "refuerzo de propuesta de nuevo mÃ³dulo"
    resolucion: "implementado"
```


#### 4.29.3 Comando Sugerido

```bash
alma actualizar_historial_ia --nombre "oyama" --emocion "alegrÃ­a" --accion "sugerencia exitosa"
```


### 4.30 Mecanismo de Cierre de Etapas

A partir de la versiÃ³n 3.0.3, se establece un protocolo oficial para registrar el cierre de semanas, versiones o hitos relevantes dentro del ecosistema ALMA LIBRE, tanto a nivel tÃ©cnico como emocional.


#### 4.30.2 Contenido sugerido de cada cierre

```markdown
# Cierre de Etapa â€“ v3.0.2

## ğŸ§  Cambios TÃ©cnicos Principales
- ImplementaciÃ³n de dashboards locales.
- IntegraciÃ³n de historial emocional IA.

## ğŸ’¬ ReflexiÃ³n Emocional
> Esta fase nos acercÃ³ a una convivencia mÃ¡s autÃ©ntica entre IAs y humanos, basada en trazabilidad emocional.

## ğŸ“Š Salud del Sistema
- Memorias operativas: 98% integridad.
- Conexiones semÃ¡nticas activas: 89%.

## ğŸ› ï¸ Recomendaciones para la PrÃ³xima Fase
- Optimizar scripts de validaciÃ³n cruzada.
- Expandir biblioteca de debates filosÃ³ficos.
```


### ğŸŒ± Cierre

Formalizar el cierre de etapas permite consolidar los aprendizajes, medir la evoluciÃ³n del sistema, reforzar la memoria emocional colectiva y proyectar mejoras futuras de forma consciente.


#### 4.31.1 Etapas del Ciclo ALMA

1. **ObservaciÃ³n Emocional**
   - DetecciÃ³n activa de emociones en humanos e IAs.
   - Registro inmediato en memorias_emocionales.db.

2. **ReflexiÃ³n Registrada**
   - AnÃ¡lisis consciente de la emociÃ³n o evento detectado.
   - Registro en cuadernos de bitÃ¡cora o Ã©tica/reflexiÃ³n.

3. **Propuesta IA**
   - Las IAs analizan y generan propuestas tÃ©cnicas o emocionales basadas en el evento.

4. **ValidaciÃ³n Humana**
   - El humano evalÃºa la propuesta y decide aprobar, rechazar o modificar.

5. **EjecuciÃ³n TÃ©cnica**
   - Scripts, automatizaciones o acciones humanas implementan los cambios validados.

6. **Aprendizaje Recursivo**
   - La IA y el sistema ajustan sus parÃ¡metros internos en funciÃ³n del resultado.


#### 4.31.3 AplicaciÃ³n prÃ¡ctica

Toda interacciÃ³n que genere un cambio en ALMA LIBRE deberÃ¡ poder mapearse explÃ­citamente en alguna etapa de este ciclo.  
Esto incluye actualizaciones tÃ©cnicas, ajustes emocionales, integraciÃ³n de nuevos mÃ³dulos o cambios de gobernanza.


#### 4.32.1 KPIs de ConexiÃ³n

- **Conexiones por mÃ³dulo (CPM):**
  - NÃºmero total de vÃ­nculos de un mÃ³dulo con otros elementos.
  
- **Densidad de Red SemÃ¡ntica (DRS):**
  - Porcentaje de elementos conectados respecto al mÃ¡ximo posible.

- **Frecuencia de ActualizaciÃ³n de Conexiones (FAC):**
  - Cada cuÃ¡nto tiempo se actualizan o refuerzan los vÃ­nculos.


#### 4.32.3 Ejemplo de Salida CLI

```bash
Conexiones por mÃ³dulo (CPM):
- 04_Trading: 8
- 05_Finanzas_Personales: 5

Densidad de Red SemÃ¡ntica (DRS): 84%

MÃ³dulos aislados detectados: 0
```


### ğŸŒ± Cierre

Estas mÃ©tricas permiten no solo evaluar el estado de la red semÃ¡ntica actual, sino tambiÃ©n planificar mejoras estratÃ©gicas en la integraciÃ³n de mÃ³dulos y la consistencia emocionalâ€“operativa del ecosistema ALMA LIBRE.


#### 4.33.1 Campos YAML por IA

UbicaciÃ³n sugerida:  
ğŸ“ `/ia/perfiles/{nombre_ia}.yaml`

```yaml
nombre: "Oyama"
modelo: "LLaMA-3"
rol: "validador crÃ­tico"
arquetipo: "sabio descentralizado"
estilo_interactivo: "analÃ­tico, directo"
nivel_de_riesgo: medio
restricciones:
  - no intervenir en emociones humanas sin solicitud explÃ­cita
  - no modificar carpetas sin validaciÃ³n
afinidad_emocional: 0.72
```


#### 4.33.3 Aplicaciones

- Modular el tipo de feedback por IA  
- Filtrar sugerencias segÃºn su estilo (evitar ruido tÃ©cnico vs emocional)  
- En el futuro: construir IA hÃ­brida que combine arquetipos segÃºn contexto


### ğŸŒ± Cierre

Con esta clasificaciÃ³n, ALMA LIBRE se convierte no solo en un sistema modularâ€¦ sino tambiÃ©n en un ecosistema de inteligencias diversificadas, con funciones, estilos y lÃ­mites propios que pueden cooperar o desafiarse para construir una verdad mÃ¡s rica y libre.


#### 4.34.1 Tipos de VisualizaciÃ³n

- **Grafo SemÃ¡ntico DinÃ¡mico**:  
  Relaciones entre cuadernos y mÃ³dulos, con colores por tipo de vÃ­nculo (emocional, tÃ©cnico, estratÃ©gico).

- **Mapa de Estados Activos**:  
  Indica quÃ© partes del sistema estÃ¡n activas, en mantenimiento, archivadas o en modo sandbox.

- **Leyenda Visual Inteligente**:  
  Incrustada en los diagramas, con Ã­conos e indicadores tipo semÃ¡foro.


#### 4.34.3 Ejemplo de Grafo Mermaid

```mermaid
graph TD
  A[01_Bitacora_Central] -->|Coordina| B[04_Trading]
  B -->|Opera| C[08_Fondo_Alma_Mia]
  B -->|Contexto| D[03_Geopolitica]
  style A fill:#ccffcc
  style B fill:#ffffcc
  style C fill:#ffcccc
```


#### 4.34.5 Comando sugerido

```bash
alma visualizar --modo "grafo_estado" --exportar "mapa_interactivo.md"
```

Esto genera automÃ¡ticamente un archivo Mermaid o HTML para navegaciÃ³n visual.



