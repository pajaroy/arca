## üß† Prompt DeepSeek ‚Äì Desarrollo Script Universal `fix_metadata` para ALMA_RESIST

**Contexto:**  
Vas a desarrollar un script profesional y auditable para el ecosistema ALMA_RESIST, alojado por convenci√≥n en:  
`core/scripts/fix_metadata/`

El script debe recorrer hacia arriba hasta la ra√≠z de cada m√≥dulo, y desde ah√≠ formatear todos los archivos cr√≠ticos (.md, .yaml, .json, .py, .sh, etc.) seg√∫n el est√°ndar de metadata universal.

---

### **√Årbol de ejemplo para contexto**

/home/bird/ALMA_RESIST/control_central/asesor-ia/centralesis/
‚îî‚îÄ‚îÄ core/
‚îî‚îÄ‚îÄ scripts/
‚îî‚îÄ‚îÄ fix_metadata/

---

### **Requerimientos funcionales:**

1. **Recorrer en profundidad** (recursivo) desde la ubicaci√≥n del script hasta la ra√≠z del m√≥dulo, y formatear todos los archivos soportados.
2. **Validar, corregir y completar** el bloque de metadata YAML seg√∫n el siguiente est√°ndar universal (ver m√°s abajo).
3. **Actualizar o a√±adir los siguientes campos obligatorios:**
   - version, id, tipo, formato, modulo, titulo, autor, fecha_creacion, fecha_actualizacion, status, version_sistema, origen, tags, hash_integridad, linked_to, descripcion.
4. **Calcular y actualizar el hash_integridad** (SHA256) del contenido (excluyendo el propio hash).
5. **Loggear** todos los cambios realizados (archivo, campos modificados, timestamp) en un log estructurado (idealmente en YAML o JSON).
6. **Generar backup** del archivo original antes de modificarlo.
7. **Modo dry-run**: permitir simular la correcci√≥n y mostrar el resultado sin modificar los archivos reales.
8. **Detectar y reportar errores**: listar los archivos que no se pueden reparar autom√°ticamente, dejar registro de ello.
9. **Ser f√°cilmente replicable**: el script debe funcionar igual si se copia a cualquier carpeta `core/scripts/fix_metadata/` de cualquier m√≥dulo ALMA_RESIST.

---

### **Est√°ndar de metadata universal a aplicar** (colocar en el encabezado de cada archivo cr√≠tico):

```yaml
---
version: 1.0
id: <tipo>_<yyyy-mm-dd>_<xx>       # Ejemplo: MEM_2025-06-06_04
tipo: <tipo_registro>              # fundacional, decision, bitacora, changelog, script, etc.
formato: <md|yaml|py|sh|json>
modulo: <modulo/carpeta>
titulo: "<t√≠tulo_breve_descriptivo>"
autor: <humano|agente>
fecha_creacion: YYYY-MM-DD
fecha_actualizacion: YYYY-MM-DD
status: <activo|cerrado|en_revision|obsoleto>
version_sistema: <sistema_version>
origen: <archivo_origen|manual>
tags: [tag1, tag2, ...]
hash_integridad: sha256:<hash>
linked_to: [relaciones_cruzadas]
descripcion: >
  Breve descripci√≥n del prop√≥sito y contexto del archivo.
---

Explicaci√≥n resumida de campos

(para documentaci√≥n interna del script, ver [IDEA_2025-06-06_01])

    version: versi√≥n de la metadata.

    id: identificador √∫nico.

    tipo: tipo de registro.

    formato: tipo de archivo.

    modulo: ruta l√≥gica.

    titulo: breve descripci√≥n.

    autor: creador/responsable.

    fecha_creacion: ISO.

    fecha_actualizacion: ISO.

    status: estado.

    version_sistema: versi√≥n ALMA_RESIST.

    origen: fuente u origen.

    tags: palabras clave.

    hash_integridad: SHA256 de todo el contenido menos este campo.

    linked_to: referencias cruzadas.

    descripcion: explicaci√≥n del prop√≥sito.

Protocolo m√≠nimo del script:

    Recorrer todos los archivos relevantes en la carpeta y subcarpetas.

    Verificar y corregir el bloque metadata YAML.

    Completar o pedir input solo si es estrictamente necesario.

    Generar backups previos a cambios.

    Loggear cada acci√≥n.

    Modo dry-run.

    Modular y reutilizable.

Extra:
El c√≥digo debe ser claro, con funciones independientes, comentarios detallados, y dejar evidencia auditable de cada cambio.

Instrucciones:

    Programar preferentemente en Python 3, usando solo dependencias est√°ndar (o avisar si hace falta alguna extra).

    Dejar toda la l√≥gica y el flujo en un solo archivo principal.

    El script debe estar listo para ejecutarse desde cualquier carpeta core/scripts/fix_metadata/.

Referencia oficial:

[IDEA_2025-06-06_01], Propuesta ALMA_RESIST, Santiago Calvo, Centralesis v2.3

¬øListo para crear el script?
Gener√° el archivo principal en core/scripts/fix_metadata/ siguiendo esta especificaci√≥n.