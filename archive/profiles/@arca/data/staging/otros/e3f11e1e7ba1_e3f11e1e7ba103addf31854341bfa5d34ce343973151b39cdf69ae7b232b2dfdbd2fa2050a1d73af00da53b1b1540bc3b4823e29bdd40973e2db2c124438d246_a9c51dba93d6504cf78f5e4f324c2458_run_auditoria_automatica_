#!/bin/bash

# ALMA_RESIST â€“ Script de auditorÃ­a automatizada Sprint 2.5
# Ejecuta: entorno, instalaciÃ³n, normalizaciÃ³n y validaciÃ³n

echo "ğŸš€ Iniciando entorno ALMA_RESIST..."

# 1. Activar entorno virtual
echo "ğŸ”§ Activando entorno virtual..."
source .venv/bin/activate

# 2. Instalar dependencias necesarias
echo "ğŸ“¦ Instalando dependencias requeridas..."
pip install -q pyyaml

# 3. Ejecutar force_snake_case_modules.py
echo "ğŸ Normalizando campo 'module' a snake_case..."
python3 docs/utilidades/scripts/force_snake_case_modules.py --verbose

# 4. Ejecutar fix_metadata.py
echo "ğŸ› ï¸ Corrigiendo metadatos YAML..."
python3 docs/utilidades/scripts/fix_metadata.py --verbose --backup

# 5. Ejecutar add_linked_to_minimo.py
echo "ğŸ”— Agregando 'linked_to' mÃ­nimo a documentos tipo 'core'..."
python3 docs/utilidades/scripts/add_linked_to_minimo.py --verbose

# 6. Ejecutar validate_docs.py
echo "âœ… Validando estructura de metadatos YAML..."
python3 docs/utilidades/scripts/validate_docs.py --verbose

echo "ğŸ‰ AuditorÃ­a automÃ¡tica finalizada."
