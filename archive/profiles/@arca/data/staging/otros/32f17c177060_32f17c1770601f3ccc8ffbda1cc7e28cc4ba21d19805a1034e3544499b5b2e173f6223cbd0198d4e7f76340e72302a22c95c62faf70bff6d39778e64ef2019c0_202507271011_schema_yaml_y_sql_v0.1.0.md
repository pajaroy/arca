¬°No hay problema! Aqu√≠ est√°n los **schemas definitivos** (SQL + YAML) listos para implementar, con todos los campos que discutimos, optimizados para tu flujo de trabajo:

---

### **1. `meta/schema.yaml`**  
```yaml
# Configuraci√≥n de validaci√≥n y documentaci√≥n
tables:
  archivos:
    columns:
      # Identificaci√≥n b√°sica
      ruta: 
        type: TEXT 
        required: true
        desc: "Ruta absoluta del archivo"
      nombre: 
        type: TEXT 
        required: true
        index: true
      tipo: 
        type: TEXT 
        allowed: ${global.formats.allowed}  # Reusa tu global.yaml
        index: true
      
      # Metadatos t√©cnicos
      tamano_bytes: 
        type: INTEGER 
        min: 0
        desc: "Tama√±o en bytes"
      fecha_mod: 
        type: TEXT 
        format: "iso8601"
        index: true
      hash_blake3: 
        type: TEXT 
        unique: true
        desc: "Hash BLAKE3 (256-bit)"
      
      # Contenido y an√°lisis
      contenido: 
        type: TEXT 
        desc: "Texto extra√≠do (para NLP)"
      palabras_limpias: 
        type: JSON
        desc: "Lista de palabras clave normalizadas"
      entidades: 
        type: JSON
        desc: "Entidades NLP: {personas: [], lugares: [], organizaciones: []}"
      
      # Relaciones y metadatos extendidos
      linked_to: 
        type: JSON
        desc: "Relaciones con otros archivos: {parent: 'hash', tipo: 'derivado'}"
      metadata: 
        type: JSON
        desc: "Metadatos t√©cnicos (EXIF, autor, etc.)"
    
    indexes:
      - hash_blake3
      - tipo
      - fecha_mod
      - entidades  # Para b√∫squeda sem√°ntica
```

---

### **2. `meta/schema.sql`**  
```sql
-- Script de creaci√≥n de la base de datos
CREATE TABLE IF NOT EXISTS archivos (
    -- Identificaci√≥n b√°sica
    ruta TEXT NOT NULL,
    nombre TEXT NOT NULL,
    tipo TEXT NOT NULL,
    
    -- Metadatos t√©cnicos
    tamano_bytes INTEGER CHECK (tamano_bytes >= 0),
    fecha_mod TEXT CHECK (datetime(fecha_mod) IS NOT NULL),
    hash_blake3 TEXT UNIQUE,
    
    -- Contenido y an√°lisis
    contenido TEXT,
    palabras_limpias TEXT,  -- JSON array
    entidades TEXT,         -- JSON: {"personas": [], ...}
    
    -- Relaciones y metadatos extendidos
    linked_to TEXT,         -- JSON: {"parent": "hash", "tipo": "derivado"}
    metadata TEXT,          -- JSON crudo
    
    -- √çndices
    INDEX idx_hash (hash_blake3),
    INDEX idx_tipo (tipo),
    INDEX idx_fecha (fecha_mod),
    INDEX idx_entidades (entidades)
);

-- Configuraci√≥n de rendimiento (opcional pero recomendado)
PRAGMA journal_mode = WAL;
PRAGMA synchronous = NORMAL;
```

---

### **Caracter√≠sticas Clave**  
1. **Consistencia total**: Los schemas SQL y YAML est√°n alineados.  
2. **JSON flexible**: Para campos como `entidades` y `linked_to`.  
3. **√çndices optimizados**: Para b√∫squedas r√°pidas por hash, tipo o fecha.  
4. **BLAKE3**: Hash r√°pido y seguro como identificador √∫nico.  

---

### **C√≥mo Usarlos**  
1. **Crear la base de datos**:  
   ```bash
   sqlite3 /home/bird/@arca/database/processed/arca.db < meta/schema.sql
   ```
2. **Validar datos**:  
   ```python
   from core.config.config import validate_data  # Usa schema.yaml
   errors = validate_data({"nombre": "test.pdf", ...}, "archivos")
   ```

---

**¬°Listo!** Con esto tienes la estructura definitiva. Ahora s√≠, ¬°a por esos 200k archivos! üöÄ  

¬øNecesitas el script de migraci√≥n para actualizar tu DB actual a este schema o prefieres empezar desde cero? üòä