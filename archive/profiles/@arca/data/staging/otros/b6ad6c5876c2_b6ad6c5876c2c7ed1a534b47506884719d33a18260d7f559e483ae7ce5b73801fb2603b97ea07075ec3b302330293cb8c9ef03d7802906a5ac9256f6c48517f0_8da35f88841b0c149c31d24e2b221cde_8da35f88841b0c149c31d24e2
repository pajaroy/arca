# âœ… Solicitud de Test â€“ `test_api_responder.py` â€“ ALMA_RESIST Sprint 2.6

Este test debe validar completamente el endpoint `/responder` expuesto por `main.py` (FastAPI), el cual estÃ¡ integrado con los siguientes mÃ³dulos:

- `model_wrapper.py` â†’ GeneraciÃ³n con llama.cpp
- `transport_layer.py` â†’ ValidaciÃ³n contra `schema_prompt.json` y persistencia
- `context_tracker.py` â†’ Registro de interacciones
- `log_writer.py` (opcional) â†’ Logging estructurado


## ğŸ“˜ Requisitos funcionales

### Endpoint: `POST /responder`

- âœ… Devuelve 200 OK con prompt vÃ¡lido
- âœ… Devuelve un `dict` con:
  - `"respuesta"`: `str`
  - `"metadata"`: `{ modelo: str, longitud_prompt: int, timestamp: float }`

### Validaciones esperadas:
- âŒ Prompt vacÃ­o â†’ `422 Unprocessable Entity` (por validaciÃ³n Pydantic)
- âŒ Modelo no cargado â†’ `503 Service Unavailable`
- âŒ Error interno (simulado) â†’ `500 Internal Server Error`


## ğŸ§ª Casos de prueba sugeridos

| Caso                                 | Esperado                        |
|--------------------------------------|----------------------------------|
| `POST /responder` con prompt vÃ¡lido  | 200 OK, estructura vÃ¡lida        |
| Prompt vacÃ­o                         | 422 (Pydantic)                   |
| Modelo no cargado                    | 503, mensaje: "modelo no cargado"|
| Respuesta sin metadata               | âŒ (debe incluirla siempre)      |
| Errores internos simulados           | 500 con mensaje de error         |


Â¿PodÃ©s generar el archivo `test_api_responder.py` siguiendo esta estructura y cubriendo todos los casos mencionados con `pytest` + `TestClient`?
